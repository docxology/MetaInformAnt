

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GWAS: Population Structure Analysis &mdash; METAINFORMANT 0.2.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=938c9ccc"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >

          
          
          <a href="../index.html" class="icon icon-home">
            METAINFORMANT
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dna/index.html">DNA: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rna/index.html">RNA: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../protein/index.html">Protein: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">GWAS (Genome-Wide Association Studies)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../epigenome/index.html">Epigenome: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../epigenome/index.html#key-components">Key Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../epigenome/index.html#integration-with-genomics">Integration with Genomics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../epigenome/index.html#analysis-workflows">Analysis Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../epigenome/index.html#planned-extensions">Planned Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ontology/index.html">Ontology Module Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../phenotype/index.html">Phenotype: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ecology/index.html">Ecology: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ecology/index.html#key-components">Key Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ecology/index.html#analysis-workflows">Analysis Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ecology/index.html#integration-with-other-modules">Integration with Other Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ecology/index.html#planned-extensions">Planned Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/index.html">Math: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ml/index.html">Machine Learning: Biological Data Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../networks/index.html">Networks: Biological Network Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../singlecell/index.html">Single-Cell Genomics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quality/index.html">Quality Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../visualization/index.html">Visualization: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../simulation/index.html">Simulation: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../life_events/index.html">Life Events Module</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../testing.html">Testing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980B9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">METAINFORMANT</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">GWAS: Population Structure Analysis</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/gwas/structure.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="gwas-population-structure-analysis">
<h1>GWAS: Population Structure Analysis<a class="headerlink" href="#gwas-population-structure-analysis" title="Link to this heading"></a></h1>
<p>Population structure analysis for GWAS, including PCA and kinship matrix computation.</p>
<p><strong>Functions</strong>: <code class="docutils literal notranslate"><span class="pre">compute_pca</span></code>, <code class="docutils literal notranslate"><span class="pre">compute_kinship_matrix</span></code>, <code class="docutils literal notranslate"><span class="pre">estimate_population_structure</span></code>.</p>
</section>
<section id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h1>
<p>Population structure analysis is essential for GWAS to:</p>
<ul class="simple">
<li><p>Detect population stratification</p></li>
<li><p>Identify related samples</p></li>
<li><p>Adjust for ancestry in association tests</p></li>
<li><p>Quality control (outlier detection)</p></li>
</ul>
<p>This module provides Principal Component Analysis (PCA) and kinship matrix
computation for genotype data.</p>
</section>
<section id="functions">
<h1>Functions<a class="headerlink" href="#functions" title="Link to this heading"></a></h1>
<section id="compute-pca-genotype-matrix-n-components-10">
<h2><code class="docutils literal notranslate"><span class="pre">compute_pca(genotype_matrix,</span> <span class="pre">n_components=10)</span></code><a class="headerlink" href="#compute-pca-genotype-matrix-n-components-10" title="Link to this heading"></a></h2>
<p>Compute Principal Component Analysis on genotype matrix.</p>
<p><strong>Parameters</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">genotype_matrix</span></code>: Genotype matrix (samples × variants), encoded as 0/1/2/-1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n_components</span></code>: Number of principal components to compute (default: 10)</p></li>
</ul>
<p><strong>Returns</strong>: Dictionary with:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pcs</span></code>: Principal components (samples × n_components)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">explained_variance</span></code>: Explained variance per component</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">explained_variance_ratio</span></code>: Explained variance ratio per component</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">status</span></code>: “success” or “failed”</p></li>
</ul>
<p><strong>Example</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">metainformant.gwas</span><span class="w"> </span><span class="kn">import</span> <span class="n">compute_pca</span>

<span class="c1"># Genotype matrix: 5 samples, 10 variants</span>
<span class="n">genotypes</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">compute_pca</span><span class="p">(</span><span class="n">genotypes</span><span class="p">,</span> <span class="n">n_components</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;success&quot;</span><span class="p">:</span>
    <span class="n">pcs</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;pcs&quot;</span><span class="p">]</span>
    <span class="n">variance_ratio</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;explained_variance_ratio&quot;</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="compute-kinship-matrix-genotype-matrix-method-vanraden">
<h2><code class="docutils literal notranslate"><span class="pre">compute_kinship_matrix(genotype_matrix,</span> <span class="pre">method=&quot;vanraden&quot;)</span></code><a class="headerlink" href="#compute-kinship-matrix-genotype-matrix-method-vanraden" title="Link to this heading"></a></h2>
<p>Compute kinship matrix from genotype data.</p>
<p><strong>Parameters</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">genotype_matrix</span></code>: Genotype matrix (samples × variants), encoded as 0/1/2/-1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">method</span></code>: Kinship calculation method:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;vanraden&quot;</span></code> (default): VanRaden method (2008)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;astle&quot;</span></code>: Astle-Balding method</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;yang&quot;</span></code>: Yang method (2011)</p></li>
</ul>
</li>
</ul>
<p><strong>Returns</strong>: Dictionary with:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">kinship_matrix</span></code>: Symmetric kinship matrix (samples × samples)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">status</span></code>: “success” or “failed”</p></li>
</ul>
<p><strong>Example</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">metainformant.gwas</span><span class="w"> </span><span class="kn">import</span> <span class="n">compute_kinship_matrix</span>

<span class="n">genotypes</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>  <span class="c1"># Identical to first</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>  <span class="c1"># Different</span>
<span class="p">]</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">compute_kinship_matrix</span><span class="p">(</span><span class="n">genotypes</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;vanraden&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;success&quot;</span><span class="p">:</span>
    <span class="n">kinship</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;kinship_matrix&quot;</span><span class="p">]</span>
    <span class="c1"># High kinship between samples 0 and 1 (identical)</span>
</pre></div>
</div>
</section>
<section id="estimate-population-structure-vcf-path-config-output-dir-none">
<h2><code class="docutils literal notranslate"><span class="pre">estimate_population_structure(vcf_path,</span> <span class="pre">config,</span> <span class="pre">output_dir=None)</span></code><a class="headerlink" href="#estimate-population-structure-vcf-path-config-output-dir-none" title="Link to this heading"></a></h2>
<p>Estimate population structure from VCF file.</p>
<p><strong>Parameters</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">vcf_path</span></code>: Path to VCF file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">config</span></code>: Dictionary with structure configuration:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">compute_pca</span></code>: Boolean (default: True)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n_components</span></code>: Number of PCs (default: 10)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">compute_relatedness</span></code>: Boolean (default: True)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kinship_method</span></code>: Method name (default: “vanraden”)</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">output_dir</span></code>: Optional directory to write results</p></li>
</ul>
<p><strong>Returns</strong>: Dictionary with PCA and kinship results</p>
<p><strong>Example</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">metainformant.gwas</span><span class="w"> </span><span class="kn">import</span> <span class="n">estimate_population_structure</span>

<span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;compute_pca&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s2">&quot;n_components&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s2">&quot;compute_relatedness&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s2">&quot;kinship_method&quot;</span><span class="p">:</span> <span class="s2">&quot;vanraden&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">estimate_population_structure</span><span class="p">(</span>
    <span class="n">vcf_path</span><span class="o">=</span><span class="s2">&quot;variants.vcf&quot;</span><span class="p">,</span>
    <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
    <span class="n">output_dir</span><span class="o">=</span><span class="s2">&quot;output/structure&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="usage-examples">
<h1>Usage Examples<a class="headerlink" href="#usage-examples" title="Link to this heading"></a></h1>
<section id="basic-pca-analysis">
<h2>Basic PCA Analysis<a class="headerlink" href="#basic-pca-analysis" title="Link to this heading"></a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">metainformant.gwas</span><span class="w"> </span><span class="kn">import</span> <span class="n">compute_pca</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Load or create genotype matrix</span>
<span class="n">genotypes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Compute PCA</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">compute_pca</span><span class="p">(</span><span class="n">genotypes</span><span class="p">,</span> <span class="n">n_components</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;success&quot;</span><span class="p">:</span>
    <span class="n">pcs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;pcs&quot;</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PC1 explains </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;explained_variance_ratio&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2"> of variance&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="kinship-matrix-for-relatedness">
<h2>Kinship Matrix for Relatedness<a class="headerlink" href="#kinship-matrix-for-relatedness" title="Link to this heading"></a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">metainformant.gwas</span><span class="w"> </span><span class="kn">import</span> <span class="n">compute_kinship_matrix</span>

<span class="c1"># Genotype matrix</span>
<span class="n">genotypes</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>  <span class="c1"># Identical to sample 0</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>  <span class="c1"># Different</span>
<span class="p">]</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">compute_kinship_matrix</span><span class="p">(</span><span class="n">genotypes</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;vanraden&quot;</span><span class="p">)</span>
<span class="n">kinship</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;kinship_matrix&quot;</span><span class="p">]</span>

<span class="c1"># High kinship indicates related samples</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kinship between samples 0 and 1: </span><span class="si">{</span><span class="n">kinship</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="full-workflow-from-vcf">
<h2>Full Workflow from VCF<a class="headerlink" href="#full-workflow-from-vcf" title="Link to this heading"></a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">metainformant.gwas</span><span class="w"> </span><span class="kn">import</span> <span class="n">estimate_population_structure</span>

<span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;compute_pca&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s2">&quot;n_components&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;compute_relatedness&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s2">&quot;kinship_method&quot;</span><span class="p">:</span> <span class="s2">&quot;vanraden&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">estimate_population_structure</span><span class="p">(</span>
    <span class="n">vcf_path</span><span class="o">=</span><span class="s2">&quot;data/genotypes.vcf&quot;</span><span class="p">,</span>
    <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
    <span class="n">output_dir</span><span class="o">=</span><span class="s2">&quot;output/population_structure&quot;</span>
<span class="p">)</span>

<span class="c1"># Results saved to:</span>
<span class="c1"># - output/population_structure/pca_components.tsv</span>
<span class="c1"># - output/population_structure/kinship_matrix.tsv</span>
<span class="c1"># - output/population_structure/structure_summary.json</span>
</pre></div>
</div>
</section>
</section>
<section id="integration-with-gwas-workflow">
<h1>Integration with GWAS Workflow<a class="headerlink" href="#integration-with-gwas-workflow" title="Link to this heading"></a></h1>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">metainformant.gwas</span><span class="w"> </span><span class="kn">import</span> <span class="n">execute_gwas_workflow</span><span class="p">,</span> <span class="n">load_gwas_config</span>

<span class="c1"># Load GWAS configuration</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">load_gwas_config</span><span class="p">(</span><span class="s2">&quot;config/gwas/analysis.yaml&quot;</span><span class="p">)</span>

<span class="c1"># Structure analysis is automatically included in workflow</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">execute_gwas_workflow</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>

<span class="c1"># Access structure results</span>
<span class="k">if</span> <span class="s2">&quot;structure&quot;</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
    <span class="n">structure</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;structure&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s2">&quot;pca&quot;</span> <span class="ow">in</span> <span class="n">structure</span><span class="p">:</span>
        <span class="n">pcs</span> <span class="o">=</span> <span class="n">structure</span><span class="p">[</span><span class="s2">&quot;pca&quot;</span><span class="p">][</span><span class="s2">&quot;pcs&quot;</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="methods">
<h1>Methods<a class="headerlink" href="#methods" title="Link to this heading"></a></h1>
<section id="vanraden-method-default">
<h2>VanRaden Method (Default)<a class="headerlink" href="#vanraden-method-default" title="Link to this heading"></a></h2>
<p>The VanRaden method (2008) computes kinship using:</p>
<ul class="simple">
<li><p>Centered genotype matrix</p></li>
<li><p>Standardized by allele frequencies</p></li>
<li><p>Suitable for dense SNP arrays</p></li>
</ul>
</section>
<section id="astle-balding-method">
<h2>Astle-Balding Method<a class="headerlink" href="#astle-balding-method" title="Link to this heading"></a></h2>
<p>Alternative method that may be more robust to:</p>
<ul class="simple">
<li><p>Missing data</p></li>
<li><p>Rare variants</p></li>
<li><p>Population structure</p></li>
</ul>
</section>
<section id="yang-method">
<h2>Yang Method<a class="headerlink" href="#yang-method" title="Link to this heading"></a></h2>
<p>Yang method (2011) from GCTA:</p>
<ul class="simple">
<li><p>Uses different normalization</p></li>
<li><p>May be more appropriate for certain datasets</p></li>
</ul>
</section>
</section>
<section id="visualization">
<h1>Visualization<a class="headerlink" href="#visualization" title="Link to this heading"></a></h1>
<p>See <code class="docutils literal notranslate"><span class="pre">metainformant.gwas.visualization_population</span></code> for plotting functions:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pca_plot()</span></code>: 2D/3D PCA scatter plots</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pca_scree_plot()</span></code>: Variance explained by each PC</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kinship_heatmap()</span></code>: Kinship matrix visualization</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">admixture_plot()</span></code>: Ancestry proportions (requires ADMIXTURE output)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">population_tree()</span></code>: Hierarchical clustering dendrogram</p></li>
</ul>
</section>
<section id="notes">
<h1>Notes<a class="headerlink" href="#notes" title="Link to this heading"></a></h1>
<ol class="arabic simple">
<li><p><strong>Missing Data</strong>: Missing genotypes (encoded as -1) are imputed using mean
imputation per variant before PCA computation.</p></li>
<li><p><strong>Data Requirements</strong>: Requires genotype data (0/1/2 encoding) or VCF file.</p></li>
<li><p><strong>Computational Cost</strong>: PCA scales with number of samples and variants.
Consider LD pruning for large datasets.</p></li>
</ol>
</section>
<section id="references">
<h1>References<a class="headerlink" href="#references" title="Link to this heading"></a></h1>
<ul class="simple">
<li><p>Price, A. L., et al. (2006). Principal components analysis corrects for
stratification in genome-wide association studies. <em>Nature Genetics</em>, 38(8), 904-909.</p></li>
<li><p>VanRaden, P. M. (2008). Efficient methods to compute genomic predictions.
<em>Journal of Dairy Science</em>, 91(11), 4414-4423.</p></li>
<li><p>Yang, J., et al. (2011). GCTA: a tool for genome-wide complex trait analysis.
<em>The American Journal of Human Genetics</em>, 88(1), 76-82.</p></li>
</ul>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, METAINFORMANT Contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>