

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quality Control &mdash; METAINFORMANT 0.2.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=938c9ccc"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Visualization: Overview" href="../visualization/index.html" />
    <link rel="prev" title="Single-Cell Genomics" href="../singlecell/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >

          
          
          <a href="../index.html" class="icon icon-home">
            METAINFORMANT
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Modules</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../dna/index.html">DNA: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rna/index.html">RNA: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../protein/index.html">Protein: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gwas/index.html">GWAS (Genome-Wide Association Studies)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../epigenome/index.html">Epigenome: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../epigenome/index.html#key-components">Key Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../epigenome/index.html#integration-with-genomics">Integration with Genomics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../epigenome/index.html#analysis-workflows">Analysis Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../epigenome/index.html#planned-extensions">Planned Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ontology/index.html">Ontology Module Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../phenotype/index.html">Phenotype: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ecology/index.html">Ecology: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ecology/index.html#key-components">Key Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ecology/index.html#analysis-workflows">Analysis Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ecology/index.html#integration-with-other-modules">Integration with Other Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ecology/index.html#planned-extensions">Planned Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/index.html">Math: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ml/index.html">Machine Learning: Biological Data Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../networks/index.html">Networks: Biological Network Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../singlecell/index.html">Single-Cell Genomics</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Quality Control</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#architecture">Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="#key-features">Key Features</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#comprehensive-analysis">Comprehensive Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastqc-compatibility">FastQC Compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="#integration">Integration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#quick-start">Quick Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="#analysis-modules">Analysis Modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fastq-analysis"><span class="xref myst">FASTQ Analysis</span></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-structure">Module Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#additional-modules">Additional Modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#contamination-detection">Contamination Detection</a></li>
<li class="toctree-l3"><a class="reference internal" href="#quality-metrics">Quality Metrics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#planned-extensions">Planned Extensions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#alignment-quality">Alignment Quality</a></li>
<li class="toctree-l3"><a class="reference internal" href="#advanced-multi-sample-analysis">Advanced Multi-Sample Analysis</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#file-format-support">File Format Support</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#current-support">Current Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="#planned-support">Planned Support</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#integration-with-analysis-pipelines">Integration with Analysis Pipelines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#preprocessing-integration">Preprocessing Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pipeline-quality-gates">Pipeline Quality Gates</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#output-formats">Output Formats</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#json-output">JSON Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="#csv-output">CSV Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="#html-report-planned">HTML Report (Planned)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#performance-characteristics">Performance Characteristics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#benchmarks">Benchmarks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#optimization-features">Optimization Features</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#best-practices">Best Practices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#quality-assessment-workflow">Quality Assessment Workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interpretation-guidelines">Interpretation Guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="#integration-with-workflows">Integration with Workflows</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#dependencies">Dependencies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#required">Required</a></li>
<li class="toctree-l3"><a class="reference internal" href="#optional">Optional</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#testing">Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#related-documentation">Related Documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../visualization/index.html">Visualization: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../simulation/index.html">Simulation: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../life_events/index.html">Life Events Module</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../testing.html">Testing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980B9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">METAINFORMANT</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Quality Control</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/quality/index.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="quality-control">
<h1>Quality Control<a class="headerlink" href="#quality-control" title="Link to this heading"></a></h1>
<p>METAINFORMANT’s quality control module provides comprehensive tools for assessing and visualizing the quality of high-throughput sequencing data.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>The quality control module offers FastQC-like functionality for analyzing FASTQ files and other sequencing data formats. It provides detailed metrics, visualizations, and reports to help researchers identify potential issues in their sequencing data before downstream analysis.</p>
</section>
<section id="architecture">
<h2>Architecture<a class="headerlink" href="#architecture" title="Link to this heading"></a></h2>
<div class="highlight-mermaid notranslate"><div class="highlight"><pre><span></span>flowchart TB
    subgraph Input[Input Data]
        A[FASTQ Files]
        B[Compressed FASTQ.gz]
        C[Multiple Files]
    end
    
    subgraph Analysis[Quality Analysis]
        D[Basic Statistics]
        E[Per-Base Quality]
        F[Per-Sequence Quality]
        G[Sequence Length Distribution]
        H[GC Content Distribution]
        I[Adapter Content]
        J[Overrepresented Sequences]
        K[Duplication Levels]
        L[N Content per Position]
        M[Quality Score Distribution]
    end
    
    subgraph Output[Output &amp; Visualization]
        N[Quality Metrics]
        O[Summary Statistics]
        P[Quality Plots]
        Q[HTML Report]
    end
    
    A --&gt; D
    B --&gt; D
    C --&gt; D
    D --&gt; E
    D --&gt; F
    D --&gt; G
    D --&gt; H
    D --&gt; I
    D --&gt; J
    D --&gt; K
    D --&gt; L
    D --&gt; M
    
    E --&gt; N
    F --&gt; N
    G --&gt; O
    H --&gt; O
    I --&gt; P
    J --&gt; P
    K --&gt; Q
    L --&gt; Q
    M --&gt; Q
</pre></div>
</div>
</section>
<section id="key-features">
<h2>Key Features<a class="headerlink" href="#key-features" title="Link to this heading"></a></h2>
<section id="comprehensive-analysis">
<h3>Comprehensive Analysis<a class="headerlink" href="#comprehensive-analysis" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Basic Statistics</strong>: Read count, length distribution, GC content</p></li>
<li><p><strong>Quality Metrics</strong>: Per-base and per-sequence quality scores</p></li>
<li><p><strong>Sequence Analysis</strong>: Length distribution, GC content, N content</p></li>
<li><p><strong>Contamination Detection</strong>: Adapter content, overrepresented sequences</p></li>
<li><p><strong>Duplication Assessment</strong>: Sequence duplication levels</p></li>
</ul>
</section>
<section id="fastqc-compatibility">
<h3>FastQC Compatibility<a class="headerlink" href="#fastqc-compatibility" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Similar Metrics</strong>: Implements most FastQC analysis modules</p></li>
<li><p><strong>Familiar Output</strong>: Results comparable to FastQC reports</p></li>
<li><p><strong>Performance</strong>: Optimized implementation with Python/NumPy</p></li>
<li><p><strong>Extensibility</strong>: Easy to add custom analysis modules</p></li>
</ul>
</section>
<section id="integration">
<h3>Integration<a class="headerlink" href="#integration" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Core Utilities</strong>: Uses METAINFORMANT’s I/O and path handling</p></li>
<li><p><strong>Batch Processing</strong>: Analyze multiple files efficiently</p></li>
<li><p><strong>Visualization</strong>: Generate publication-ready plots</p></li>
<li><p><strong>Output Flexibility</strong>: JSON, CSV, and HTML report formats</p></li>
</ul>
</section>
</section>
<section id="quick-start">
<h2>Quick Start<a class="headerlink" href="#quick-start" title="Link to this heading"></a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">metainformant.quality.fastq</span><span class="w"> </span><span class="kn">import</span> <span class="n">analyze_fastq_quality</span>

<span class="c1"># Analyze single FASTQ file</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">analyze_fastq_quality</span><span class="p">(</span><span class="s2">&quot;sample.fastq.gz&quot;</span><span class="p">)</span>

<span class="c1"># Print basic statistics</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Basic Statistics:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Total sequences: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;basic_stats&#39;</span><span class="p">][</span><span class="s1">&#39;total_sequences&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Sequence length: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;basic_stats&#39;</span><span class="p">][</span><span class="s1">&#39;sequence_length&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  GC content: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;basic_stats&#39;</span><span class="p">][</span><span class="s1">&#39;gc_content&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Mean quality: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;basic_stats&#39;</span><span class="p">][</span><span class="s1">&#39;mean_quality&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Check for issues</span>
<span class="k">if</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;adapter_content&#39;</span><span class="p">][</span><span class="s1">&#39;max_adapter_content&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: High adapter content detected&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;basic_stats&#39;</span><span class="p">][</span><span class="s1">&#39;mean_quality&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">28</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: Low mean quality score&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="analysis-modules">
<h2>Analysis Modules<a class="headerlink" href="#analysis-modules" title="Link to this heading"></a></h2>
<section id="fastq-analysis">
<h3><a class="reference internal" href="fastq.html"><span class="std std-doc">FASTQ Analysis</span></a><a class="headerlink" href="#fastq-analysis" title="Link to this heading"></a></h3>
<p>Comprehensive quality assessment for FASTQ sequencing files including:</p>
<ul class="simple">
<li><p>Per-base quality scores and nucleotide content</p></li>
<li><p>Sequence length and GC content distributions</p></li>
<li><p>Adapter contamination detection</p></li>
<li><p>Duplicate sequence identification</p></li>
<li><p>Overrepresented sequence analysis</p></li>
</ul>
</section>
</section>
<section id="module-structure">
<h2>Module Structure<a class="headerlink" href="#module-structure" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong><a class="reference internal" href="fastq.html"><span class="std std-doc">fastq.py</span></a></strong>: Complete FASTQ quality analysis suite</p></li>
</ul>
</section>
<section id="additional-modules">
<h2>Additional Modules<a class="headerlink" href="#additional-modules" title="Link to this heading"></a></h2>
<section id="contamination-detection">
<h3>Contamination Detection<a class="headerlink" href="#contamination-detection" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Cross-species contamination</strong>: Detect reads from unexpected organisms</p></li>
<li><p><strong>rRNA contamination</strong>: Identify ribosomal RNA sequences</p></li>
<li><p><strong>Mycoplasma detection</strong>: Screen for common cell culture contaminants</p></li>
<li><p><strong>Adapter detection</strong>: Identify and remove adapter sequences</p></li>
<li><p><strong>Vector contamination</strong>: Detect plasmid and vector sequences</p></li>
</ul>
</section>
<section id="quality-metrics">
<h3>Quality Metrics<a class="headerlink" href="#quality-metrics" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Quality score calculations</strong>: Comprehensive quality scoring algorithms</p></li>
<li><p><strong>Completeness and accuracy metrics</strong>: Statistical quality assessments</p></li>
<li><p><strong>Batch effect detection</strong>: Identify systematic differences between samples</p></li>
<li><p><strong>Quality normalization</strong>: Correct for technical artifacts</p></li>
</ul>
</section>
</section>
<section id="planned-extensions">
<h2>Planned Extensions<a class="headerlink" href="#planned-extensions" title="Link to this heading"></a></h2>
<p>Future quality control modules will include:</p>
<section id="alignment-quality">
<h3>Alignment Quality<a class="headerlink" href="#alignment-quality" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>BAM/SAM analysis</strong>: Quality metrics for aligned reads</p></li>
<li><p><strong>Mapping statistics</strong>: Alignment rates and insert size distributions</p></li>
<li><p><strong>Coverage analysis</strong>: Depth and evenness of coverage</p></li>
</ul>
</section>
<section id="advanced-multi-sample-analysis">
<h3>Advanced Multi-Sample Analysis<a class="headerlink" href="#advanced-multi-sample-analysis" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Sample correlation</strong>: Compare samples for consistency</p></li>
<li><p><strong>Outlier detection</strong>: Identify problematic samples</p></li>
<li><p><strong>Reproducibility assessment</strong>: Technical and biological replicate analysis</p></li>
</ul>
</section>
</section>
<section id="file-format-support">
<h2>File Format Support<a class="headerlink" href="#file-format-support" title="Link to this heading"></a></h2>
<section id="current-support">
<h3>Current Support<a class="headerlink" href="#current-support" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>FASTQ</strong>: Standard and compressed (.gz) formats</p></li>
<li><p><strong>Multi-file</strong>: Batch processing of multiple FASTQ files</p></li>
<li><p><strong>Paired-end</strong>: Support for R1/R2 paired files</p></li>
</ul>
</section>
<section id="planned-support">
<h3>Planned Support<a class="headerlink" href="#planned-support" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>BAM/SAM</strong>: Aligned read quality assessment</p></li>
<li><p><strong>FASTA</strong>: Sequence quality for assembled genomes</p></li>
<li><p><strong>BCL</strong>: Direct analysis from Illumina base calls</p></li>
</ul>
</section>
</section>
<section id="integration-with-analysis-pipelines">
<h2>Integration with Analysis Pipelines<a class="headerlink" href="#integration-with-analysis-pipelines" title="Link to this heading"></a></h2>
<section id="preprocessing-integration">
<h3>Preprocessing Integration<a class="headerlink" href="#preprocessing-integration" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">metainformant.quality.fastq</span><span class="w"> </span><span class="kn">import</span> <span class="n">analyze_fastq_quality</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">metainformant.dna.fastq</span><span class="w"> </span><span class="kn">import</span> <span class="n">process_fastq_file</span>

<span class="c1"># 1. Quality assessment</span>
<span class="n">qc_results</span> <span class="o">=</span> <span class="n">analyze_fastq_quality</span><span class="p">(</span><span class="s2">&quot;raw_reads.fastq.gz&quot;</span><span class="p">)</span>

<span class="c1"># 2. Apply quality filters based on QC results</span>
<span class="k">if</span> <span class="n">qc_results</span><span class="p">[</span><span class="s1">&#39;basic_stats&#39;</span><span class="p">][</span><span class="s1">&#39;mean_quality&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">30</span><span class="p">:</span>
    <span class="c1"># High quality - minimal filtering</span>
    <span class="n">filtered_reads</span> <span class="o">=</span> <span class="n">process_fastq_file</span><span class="p">(</span>
        <span class="s2">&quot;raw_reads.fastq.gz&quot;</span><span class="p">,</span>
        <span class="n">min_quality</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">min_length</span><span class="o">=</span><span class="mi">50</span>
    <span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># Lower quality - more stringent filtering</span>
    <span class="n">filtered_reads</span> <span class="o">=</span> <span class="n">process_fastq_file</span><span class="p">(</span>
        <span class="s2">&quot;raw_reads.fastq.gz&quot;</span><span class="p">,</span> 
        <span class="n">min_quality</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
        <span class="n">min_length</span><span class="o">=</span><span class="mi">75</span>
    <span class="p">)</span>
</pre></div>
</div>
</section>
<section id="pipeline-quality-gates">
<h3>Pipeline Quality Gates<a class="headerlink" href="#pipeline-quality-gates" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">quality_gate_check</span><span class="p">(</span><span class="n">qc_results</span><span class="p">,</span> <span class="n">thresholds</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determine if sequencing data passes quality thresholds.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        qc_results: Results from analyze_fastq_quality()</span>
<span class="sd">        thresholds: Dictionary of quality thresholds</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        bool: True if data passes all thresholds</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="n">thresholds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">thresholds</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;min_mean_quality&#39;</span><span class="p">:</span> <span class="mi">28</span><span class="p">,</span>
            <span class="s1">&#39;max_adapter_content&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
            <span class="s1">&#39;max_n_content&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="s1">&#39;min_total_sequences&#39;</span><span class="p">:</span> <span class="mi">1000000</span>
        <span class="p">}</span>
    
    <span class="n">checks</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;mean_quality&#39;</span><span class="p">:</span> <span class="n">qc_results</span><span class="p">[</span><span class="s1">&#39;basic_stats&#39;</span><span class="p">][</span><span class="s1">&#39;mean_quality&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">thresholds</span><span class="p">[</span><span class="s1">&#39;min_mean_quality&#39;</span><span class="p">],</span>
        <span class="s1">&#39;adapter_content&#39;</span><span class="p">:</span> <span class="n">qc_results</span><span class="p">[</span><span class="s1">&#39;adapter_content&#39;</span><span class="p">][</span><span class="s1">&#39;max_adapter_content&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">thresholds</span><span class="p">[</span><span class="s1">&#39;max_adapter_content&#39;</span><span class="p">],</span>
        <span class="s1">&#39;n_content&#39;</span><span class="p">:</span> <span class="n">qc_results</span><span class="p">[</span><span class="s1">&#39;n_content_per_position&#39;</span><span class="p">][</span><span class="s1">&#39;max_n_content&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">thresholds</span><span class="p">[</span><span class="s1">&#39;max_n_content&#39;</span><span class="p">],</span>
        <span class="s1">&#39;sequence_count&#39;</span><span class="p">:</span> <span class="n">qc_results</span><span class="p">[</span><span class="s1">&#39;basic_stats&#39;</span><span class="p">][</span><span class="s1">&#39;total_sequences&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">thresholds</span><span class="p">[</span><span class="s1">&#39;min_total_sequences&#39;</span><span class="p">]</span>
    <span class="p">}</span>
    
    <span class="n">all_passed</span> <span class="o">=</span> <span class="nb">all</span><span class="p">(</span><span class="n">checks</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">all_passed</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Quality gate failures:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">check</span><span class="p">,</span> <span class="n">passed</span> <span class="ow">in</span> <span class="n">checks</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">passed</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  - </span><span class="si">{</span><span class="n">check</span><span class="si">}</span><span class="s2">: FAIL&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">all_passed</span>

<span class="c1"># Example usage</span>
<span class="k">if</span> <span class="n">quality_gate_check</span><span class="p">(</span><span class="n">qc_results</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;✓ Data passes quality gates - proceeding with analysis&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;✗ Data fails quality gates - consider preprocessing or exclusion&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="output-formats">
<h2>Output Formats<a class="headerlink" href="#output-formats" title="Link to this heading"></a></h2>
<section id="json-output">
<h3>JSON Output<a class="headerlink" href="#json-output" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Structured data for programmatic access</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">analyze_fastq_quality</span><span class="p">(</span><span class="s2">&quot;sample.fastq.gz&quot;</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="p">)</span>

<span class="c1"># Save results</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;qc_results.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="csv-output">
<h3>CSV Output<a class="headerlink" href="#csv-output" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tabular format for spreadsheet analysis</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">analyze_fastq_quality</span><span class="p">(</span><span class="s2">&quot;sample.fastq.gz&quot;</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="s2">&quot;csv&quot;</span><span class="p">)</span>

<span class="c1"># Results saved as CSV files:</span>
<span class="c1"># - basic_stats.csv</span>
<span class="c1"># - per_base_quality.csv  </span>
<span class="c1"># - sequence_length_distribution.csv</span>
<span class="c1"># - etc.</span>
</pre></div>
</div>
</section>
<section id="html-report-planned">
<h3>HTML Report (Planned)<a class="headerlink" href="#html-report-planned" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Interactive HTML report similar to FastQC</span>
<span class="n">generate_html_report</span><span class="p">(</span><span class="n">qc_results</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="s2">&quot;qc_report.html&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="performance-characteristics">
<h2>Performance Characteristics<a class="headerlink" href="#performance-characteristics" title="Link to this heading"></a></h2>
<section id="benchmarks">
<h3>Benchmarks<a class="headerlink" href="#benchmarks" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Processing Speed</strong>: ~1-2 million reads per minute</p></li>
<li><p><strong>Memory Usage</strong>: &lt;1GB for typical FASTQ files</p></li>
<li><p><strong>Scalability</strong>: Linear scaling with file size</p></li>
<li><p><strong>Parallel Processing</strong>: Support for multi-file batch analysis</p></li>
</ul>
</section>
<section id="optimization-features">
<h3>Optimization Features<a class="headerlink" href="#optimization-features" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Streaming Analysis</strong>: Process large files without loading into memory</p></li>
<li><p><strong>Compressed Input</strong>: Direct analysis of gzipped files</p></li>
<li><p><strong>Sampling</strong>: Optional subsampling for very large datasets</p></li>
<li><p><strong>Caching</strong>: Cache intermediate results for repeated analysis</p></li>
</ul>
</section>
</section>
<section id="best-practices">
<h2>Best Practices<a class="headerlink" href="#best-practices" title="Link to this heading"></a></h2>
<section id="quality-assessment-workflow">
<h3>Quality Assessment Workflow<a class="headerlink" href="#quality-assessment-workflow" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p><strong>Pre-analysis QC</strong>: Always run quality control before any analysis</p></li>
<li><p><strong>Threshold Setting</strong>: Establish appropriate quality thresholds for your application</p></li>
<li><p><strong>Comparative Analysis</strong>: Compare quality metrics across samples</p></li>
<li><p><strong>Documentation</strong>: Keep detailed records of quality metrics and decisions</p></li>
</ol>
</section>
<section id="interpretation-guidelines">
<h3>Interpretation Guidelines<a class="headerlink" href="#interpretation-guidelines" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p><strong>Quality Scores</strong>: Phred scores ≥30 are generally considered high quality</p></li>
<li><p><strong>GC Content</strong>: Should match expected values for your organism</p></li>
<li><p><strong>Adapter Content</strong>: &lt;1% is ideal, &gt;20% requires attention</p></li>
<li><p><strong>Duplication</strong>: High duplication may indicate PCR artifacts or low complexity</p></li>
</ol>
</section>
<section id="integration-with-workflows">
<h3>Integration with Workflows<a class="headerlink" href="#integration-with-workflows" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p><strong>Automated QC</strong>: Integrate quality checks into analysis pipelines</p></li>
<li><p><strong>Quality Gates</strong>: Use QC results to automatically filter poor samples</p></li>
<li><p><strong>Parameter Optimization</strong>: Adjust analysis parameters based on QC results</p></li>
<li><p><strong>Reporting</strong>: Include QC metrics in final analysis reports</p></li>
</ol>
</section>
</section>
<section id="dependencies">
<h2>Dependencies<a class="headerlink" href="#dependencies" title="Link to this heading"></a></h2>
<section id="required">
<h3>Required<a class="headerlink" href="#required" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">numpy</span></code>: Numerical computations</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pandas</span></code>: Data manipulation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scipy</span></code>: Statistical functions</p></li>
</ul>
</section>
<section id="optional">
<h3>Optional<a class="headerlink" href="#optional" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>: For generating quality plots</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">seaborn</span></code>: Enhanced visualization</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plotly</span></code>: Interactive quality reports</p></li>
</ul>
</section>
</section>
<section id="testing">
<h2>Testing<a class="headerlink" href="#testing" title="Link to this heading"></a></h2>
<p>Comprehensive tests are available in <code class="docutils literal notranslate"><span class="pre">tests/test_quality_fastq.py</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run quality control tests</span>
uv<span class="w"> </span>run<span class="w"> </span>pytest<span class="w"> </span>tests/test_quality_fastq.py<span class="w"> </span>-v
</pre></div>
</div>
</section>
<section id="related-documentation">
<h2>Related Documentation<a class="headerlink" href="#related-documentation" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="fastq.html"><span class="std std-doc">FASTQ Analysis</span></a>: Detailed FASTQ quality assessment</p></li>
<li><p><a class="reference internal" href="../dna/fastq.html"><span class="std std-doc">DNA FASTQ Processing</span></a>: FASTQ sequence processing</p></li>
<li><p><a class="reference internal" href="../core/io.html"><span class="std std-doc">Core I/O</span></a>: File handling utilities</p></li>
<li><p><a class="reference internal" href="../visualization/plots.html"><span class="std std-doc">Visualization</span></a>: Quality plot generation</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../singlecell/index.html" class="btn btn-neutral float-left" title="Single-Cell Genomics" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../visualization/index.html" class="btn btn-neutral float-right" title="Visualization: Overview" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, METAINFORMANT Contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>