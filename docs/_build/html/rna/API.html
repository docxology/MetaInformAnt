

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RNA Module API Reference &mdash; METAINFORMANT 0.2.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=938c9ccc"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >

          
          
          <a href="../index.html" class="icon icon-home">
            METAINFORMANT
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dna/index.html">DNA: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">RNA: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../protein/index.html">Protein: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gwas/index.html">GWAS (Genome-Wide Association Studies)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../epigenome/index.html">Epigenome: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../epigenome/index.html#key-components">Key Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../epigenome/index.html#integration-with-genomics">Integration with Genomics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../epigenome/index.html#analysis-workflows">Analysis Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../epigenome/index.html#planned-extensions">Planned Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ontology/index.html">Ontology Module Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../phenotype/index.html">Phenotype: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ecology/index.html">Ecology: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ecology/index.html#key-components">Key Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ecology/index.html#analysis-workflows">Analysis Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ecology/index.html#integration-with-other-modules">Integration with Other Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ecology/index.html#planned-extensions">Planned Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/index.html">Math: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ml/index.html">Machine Learning: Biological Data Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../networks/index.html">Networks: Biological Network Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../singlecell/index.html">Single-Cell Genomics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quality/index.html">Quality Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../visualization/index.html">Visualization: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../simulation/index.html">Simulation: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../life_events/index.html">Life Events Module</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../testing.html">Testing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980B9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">METAINFORMANT</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">RNA Module API Reference</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/rna/API.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="rna-module-api-reference">
<h1>RNA Module API Reference<a class="headerlink" href="#rna-module-api-reference" title="Link to this heading"></a></h1>
<p>Complete function and method reference for the METAINFORMANT RNA analysis module.</p>
<section id="quick-navigation">
<h2>Quick Navigation<a class="headerlink" href="#quick-navigation" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#amalgkit-step-functions">Amalgkit Step Functions</a> - High-level step wrappers</p></li>
<li><p><a class="reference internal" href="#step-runner-functions">Step Runner Functions</a> - Low-level step execution</p></li>
<li><p><a class="reference internal" href="#workflow-functions">Workflow Functions</a> - Workflow planning and execution</p></li>
<li><p><a class="reference internal" href="#genome-preparation-functions">Genome Preparation Functions</a> - Genome setup and indexing</p></li>
<li><p><a class="reference internal" href="#orchestration-functions">Orchestration Functions</a> - Multi-species workflow management</p></li>
<li><p><a class="reference internal" href="#utility-functions">Utility Functions</a> - CLI helpers and checks</p></li>
<li><p><a class="reference internal" href="#processing-functions">Processing Functions</a> - Sample processing pipelines</p></li>
<li><p><a class="reference internal" href="#monitoring-functions">Monitoring Functions</a> - Workflow progress and sample status tracking</p></li>
<li><p><a class="reference internal" href="#environment-functions">Environment Functions</a> - Tool availability and environment validation</p></li>
<li><p><a class="reference internal" href="#cleanup-functions">Cleanup Functions</a> - Partial download cleanup and file naming fixes</p></li>
<li><p><a class="reference internal" href="#discovery-functions">Discovery Functions</a> - Species discovery and configuration generation</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="amalgkit-step-functions">
<h2>Amalgkit Step Functions<a class="headerlink" href="#amalgkit-step-functions" title="Link to this heading"></a></h2>
<p>High-level wrapper functions for each amalgkit subcommand. These functions provide a clean Python interface to the amalgkit CLI.</p>
<section id="metadata">
<h3><code class="docutils literal notranslate"><span class="pre">metadata</span></code><a class="headerlink" href="#metadata" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">metadata</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">AmalgkitParams</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CompletedProcess</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Purpose</strong>: Retrieve RNA-seq metadata from NCBI SRA/ENA databases.</p>
<p><strong>Parameters</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">params</span></code>: Dictionary of amalgkit parameters (e.g., <code class="docutils literal notranslate"><span class="pre">{&quot;out_dir&quot;:</span> <span class="pre">&quot;work&quot;,</span> <span class="pre">&quot;search_string&quot;:</span> <span class="pre">&quot;...&quot;}</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>: Additional arguments passed to <code class="docutils literal notranslate"><span class="pre">run_amalgkit</span></code> (e.g., <code class="docutils literal notranslate"><span class="pre">work_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">log_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">check</span></code>)</p></li>
</ul>
<p><strong>Returns</strong>: <code class="docutils literal notranslate"><span class="pre">subprocess.CompletedProcess[str]</span></code> with execution results</p>
<p><strong>See Also</strong>: <a class="reference internal" href="#amalgkit/steps/metadata.md"><span class="xref myst">Step Documentation: metadata</span></a></p>
</section>
<hr class="docutils" />
<section id="integrate">
<h3><code class="docutils literal notranslate"><span class="pre">integrate</span></code><a class="headerlink" href="#integrate" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">integrate</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">AmalgkitParams</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CompletedProcess</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Purpose</strong>: Integrate FASTQ file paths into metadata tables.</p>
<p><strong>See Also</strong>: <a class="reference internal" href="#amalgkit/steps/integrate.md"><span class="xref myst">Step Documentation: integrate</span></a></p>
</section>
<hr class="docutils" />
<section id="config">
<h3><code class="docutils literal notranslate"><span class="pre">config</span></code><a class="headerlink" href="#config" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">config</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">AmalgkitParams</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CompletedProcess</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Purpose</strong>: Generate configuration files for metadata selection.</p>
<p><strong>See Also</strong>: <a class="reference internal" href="#amalgkit/steps/config.md"><span class="xref myst">Step Documentation: config</span></a></p>
</section>
<hr class="docutils" />
<section id="select">
<h3><code class="docutils literal notranslate"><span class="pre">select</span></code><a class="headerlink" href="#select" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">select</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">AmalgkitParams</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CompletedProcess</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Purpose</strong>: Select and filter SRA entries based on quality criteria.</p>
<p><strong>See Also</strong>: <a class="reference internal" href="#amalgkit/steps/select.md"><span class="xref myst">Step Documentation: select</span></a></p>
</section>
<hr class="docutils" />
<section id="getfastq">
<h3><code class="docutils literal notranslate"><span class="pre">getfastq</span></code><a class="headerlink" href="#getfastq" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">getfastq</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">AmalgkitParams</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CompletedProcess</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Purpose</strong>: Download and convert SRA files to FASTQ format.</p>
<p><strong>See Also</strong>: <a class="reference internal" href="#amalgkit/steps/getfastq.md"><span class="xref myst">Step Documentation: getfastq</span></a></p>
</section>
<hr class="docutils" />
<section id="quant">
<h3><code class="docutils literal notranslate"><span class="pre">quant</span></code><a class="headerlink" href="#quant" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">quant</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">AmalgkitParams</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CompletedProcess</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Purpose</strong>: Quantify transcript abundances using kallisto or salmon.</p>
<p><strong>See Also</strong>: <a class="reference internal" href="#amalgkit/steps/quant.md"><span class="xref myst">Step Documentation: quant</span></a></p>
</section>
<hr class="docutils" />
<section id="merge">
<h3><code class="docutils literal notranslate"><span class="pre">merge</span></code><a class="headerlink" href="#merge" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">merge</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">AmalgkitParams</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CompletedProcess</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Purpose</strong>: Merge per-sample quantification results into expression matrices.</p>
<p><strong>See Also</strong>: <a class="reference internal" href="#amalgkit/steps/merge.md"><span class="xref myst">Step Documentation: merge</span></a></p>
</section>
<hr class="docutils" />
<section id="cstmm">
<h3><code class="docutils literal notranslate"><span class="pre">cstmm</span></code><a class="headerlink" href="#cstmm" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">cstmm</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">AmalgkitParams</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CompletedProcess</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Purpose</strong>: Cross-species TMM (Trimmed Mean of M-values) normalization.</p>
<p><strong>See Also</strong>: <a class="reference internal" href="#amalgkit/steps/cstmm.md"><span class="xref myst">Step Documentation: cstmm</span></a></p>
</section>
<hr class="docutils" />
<section id="curate">
<h3><code class="docutils literal notranslate"><span class="pre">curate</span></code><a class="headerlink" href="#curate" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">curate</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">AmalgkitParams</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CompletedProcess</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Purpose</strong>: Quality control, outlier detection, and batch effect correction.</p>
<p><strong>See Also</strong>: <a class="reference internal" href="#amalgkit/steps/curate.md"><span class="xref myst">Step Documentation: curate</span></a></p>
</section>
<hr class="docutils" />
<section id="csca">
<h3><code class="docutils literal notranslate"><span class="pre">csca</span></code><a class="headerlink" href="#csca" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">csca</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">AmalgkitParams</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CompletedProcess</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Purpose</strong>: Cross-species correlation analysis and visualization.</p>
<p><strong>See Also</strong>: <a class="reference internal" href="#amalgkit/steps/csca.md"><span class="xref myst">Step Documentation: csca</span></a></p>
</section>
<hr class="docutils" />
<section id="sanity">
<h3><code class="docutils literal notranslate"><span class="pre">sanity</span></code><a class="headerlink" href="#sanity" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">sanity</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">AmalgkitParams</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CompletedProcess</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Purpose</strong>: Validate workflow outputs and check data integrity.</p>
<p><strong>See Also</strong>: <a class="reference internal" href="#amalgkit/steps/sanity.md"><span class="xref myst">Step Documentation: sanity</span></a></p>
</section>
</section>
<hr class="docutils" />
<section id="step-runner-functions">
<h2>Step Runner Functions<a class="headerlink" href="#step-runner-functions" title="Link to this heading"></a></h2>
<p>Low-level step execution functions that provide more control over step execution. These are used internally by workflow orchestration but can also be called directly.</p>
<section id="run-metadata">
<h3><code class="docutils literal notranslate"><span class="pre">run_metadata</span></code><a class="headerlink" href="#run-metadata" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">run_metadata</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">work_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">log_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">check</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CompletedProcess</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.steps.metadata</span></code></p>
<p><strong>Purpose</strong>: Execute metadata retrieval step with explicit directory control.</p>
</section>
<hr class="docutils" />
<section id="run-integrate">
<h3><code class="docutils literal notranslate"><span class="pre">run_integrate</span></code><a class="headerlink" href="#run-integrate" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">run_integrate</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">work_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">log_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">check</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CompletedProcess</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.steps.integrate</span></code></p>
</section>
<hr class="docutils" />
<section id="run-config">
<h3><code class="docutils literal notranslate"><span class="pre">run_config</span></code><a class="headerlink" href="#run-config" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">run_config</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">work_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">log_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">check</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CompletedProcess</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.steps.config</span></code></p>
</section>
<hr class="docutils" />
<section id="run-select">
<h3><code class="docutils literal notranslate"><span class="pre">run_select</span></code><a class="headerlink" href="#run-select" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">run_select</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">work_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">log_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">check</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CompletedProcess</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.steps.select</span></code></p>
</section>
<hr class="docutils" />
<section id="run-getfastq">
<h3><code class="docutils literal notranslate"><span class="pre">run_getfastq</span></code><a class="headerlink" href="#run-getfastq" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">run_getfastq</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">work_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">log_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">check</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CompletedProcess</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.steps.getfastq</span></code></p>
<p><strong>Note</strong>: Includes robust retry logic and fallback mechanisms for failed downloads.</p>
</section>
<hr class="docutils" />
<section id="run-quant">
<h3><code class="docutils literal notranslate"><span class="pre">run_quant</span></code><a class="headerlink" href="#run-quant" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">run_quant</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">work_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">log_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">check</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CompletedProcess</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.steps.quant</span></code></p>
</section>
<hr class="docutils" />
<section id="run-merge">
<h3><code class="docutils literal notranslate"><span class="pre">run_merge</span></code><a class="headerlink" href="#run-merge" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">run_merge</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">work_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">log_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">check</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CompletedProcess</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.steps.merge</span></code></p>
</section>
<hr class="docutils" />
<section id="run-cstmm">
<h3><code class="docutils literal notranslate"><span class="pre">run_cstmm</span></code><a class="headerlink" href="#run-cstmm" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">run_cstmm</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">work_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">log_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">check</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CompletedProcess</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.steps.cstmm</span></code></p>
</section>
<hr class="docutils" />
<section id="run-curate">
<h3><code class="docutils literal notranslate"><span class="pre">run_curate</span></code><a class="headerlink" href="#run-curate" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">run_curate</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">work_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">log_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">check</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CompletedProcess</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.steps.curate</span></code></p>
</section>
<hr class="docutils" />
<section id="run-csca">
<h3><code class="docutils literal notranslate"><span class="pre">run_csca</span></code><a class="headerlink" href="#run-csca" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">run_csca</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">work_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">log_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">check</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CompletedProcess</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.steps.csca</span></code></p>
</section>
<hr class="docutils" />
<section id="run-sanity">
<h3><code class="docutils literal notranslate"><span class="pre">run_sanity</span></code><a class="headerlink" href="#run-sanity" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">run_sanity</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">work_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">log_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">check</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CompletedProcess</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.steps.sanity</span></code></p>
</section>
</section>
<hr class="docutils" />
<section id="workflow-functions">
<h2>Workflow Functions<a class="headerlink" href="#workflow-functions" title="Link to this heading"></a></h2>
<p>Functions for planning and executing complete RNA-seq workflows.</p>
<section id="load-workflow-config">
<h3><code class="docutils literal notranslate"><span class="pre">load_workflow_config</span></code><a class="headerlink" href="#load-workflow-config" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">load_workflow_config</span><span class="p">(</span><span class="n">config_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AmalgkitWorkflowConfig</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.workflow</span></code></p>
<p><strong>Purpose</strong>: Load workflow configuration from YAML file.</p>
<p><strong>Parameters</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">config_file</span></code>: Path to YAML configuration file</p></li>
</ul>
<p><strong>Returns</strong>: <code class="docutils literal notranslate"><span class="pre">AmalgkitWorkflowConfig</span></code> dataclass instance</p>
<p><strong>See Also</strong>: <a class="reference internal" href="CONFIGURATION.html"><span class="std std-doc">Configuration Guide</span></a></p>
</section>
<hr class="docutils" />
<section id="plan-workflow">
<h3><code class="docutils literal notranslate"><span class="pre">plan_workflow</span></code><a class="headerlink" href="#plan-workflow" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plan_workflow</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">AmalgkitWorkflowConfig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">AmalgkitParams</span><span class="p">]]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.workflow</span></code></p>
<p><strong>Purpose</strong>: Generate ordered list of workflow steps with parameters (dry-run planning).</p>
<p><strong>Parameters</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">config</span></code>: Workflow configuration</p></li>
</ul>
<p><strong>Returns</strong>: List of <code class="docutils literal notranslate"><span class="pre">(step_name,</span> <span class="pre">params)</span></code> tuples in execution order</p>
<p><strong>See Also</strong>: <a class="reference internal" href="workflow.html"><span class="std std-doc">Workflow Guide</span></a></p>
</section>
<hr class="docutils" />
<section id="plan-workflow-with-params">
<h3><code class="docutils literal notranslate"><span class="pre">plan_workflow_with_params</span></code><a class="headerlink" href="#plan-workflow-with-params" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plan_workflow_with_params</span><span class="p">(</span>
    <span class="n">config</span><span class="p">:</span> <span class="n">AmalgkitWorkflowConfig</span><span class="p">,</span>
    <span class="n">step_params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">AmalgkitParams</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">AmalgkitParams</span><span class="p">]]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.workflow</span></code></p>
<p><strong>Purpose</strong>: Plan workflow with explicit per-step parameter overrides.</p>
</section>
<hr class="docutils" />
<section id="execute-workflow">
<h3><code class="docutils literal notranslate"><span class="pre">execute_workflow</span></code><a class="headerlink" href="#execute-workflow" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">execute_workflow</span><span class="p">(</span>
    <span class="n">config</span><span class="p">:</span> <span class="n">AmalgkitWorkflowConfig</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">check</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">walk</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">show_commands</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.workflow</span></code></p>
<p><strong>Purpose</strong>: Execute complete workflow from configuration.</p>
<p><strong>Parameters</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">config</span></code>: Workflow configuration</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code>: If True, raise exception on step failure</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">walk</span></code>: If True (and running in a TTY), pause before each stage and wait for Enter</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">progress</span></code>: If True, show a stage-level progress bar (uses tqdm if available)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">show_commands</span></code>: If True, log the exact <code class="docutils literal notranslate"><span class="pre">amalgkit</span> <span class="pre">...</span></code> command for each stage before running it</p></li>
</ul>
<p><strong>Returns</strong>: List of return codes (one per step)</p>
<p><strong>See Also</strong>: <a class="reference internal" href="workflow.html"><span class="std std-doc">Workflow Guide</span></a></p>
</section>
<hr class="docutils" />
<section id="amalgkitworkflowconfig">
<h3><code class="docutils literal notranslate"><span class="pre">AmalgkitWorkflowConfig</span></code><a class="headerlink" href="#amalgkitworkflowconfig" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">AmalgkitWorkflowConfig</span><span class="p">:</span>
    <span class="n">work_dir</span><span class="p">:</span> <span class="n">Path</span>
    <span class="n">threads</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="n">species_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">log_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">manifest_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">per_step</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">AmalgkitParams</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">auto_install_amalgkit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">genome</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">filters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.workflow</span></code></p>
<p><strong>Purpose</strong>: Configuration dataclass for workflow execution.</p>
<p><strong>See Also</strong>: <a class="reference internal" href="CONFIGURATION.html"><span class="std std-doc">Configuration Guide</span></a></p>
</section>
</section>
<hr class="docutils" />
<section id="genome-preparation-functions">
<h2>Genome Preparation Functions<a class="headerlink" href="#genome-preparation-functions" title="Link to this heading"></a></h2>
<p>Functions for downloading genomes, preparing transcriptomes, and building kallisto indexes.</p>
<section id="prepare-genome-for-quantification">
<h3><code class="docutils literal notranslate"><span class="pre">prepare_genome_for_quantification</span></code><a class="headerlink" href="#prepare-genome-for-quantification" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">prepare_genome_for_quantification</span><span class="p">(</span>
    <span class="n">genome_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">species_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">work_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">accession</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">build_index</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">kmer_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">31</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.genome_prep</span></code></p>
<p><strong>Purpose</strong>: Complete genome preparation pipeline (download → extract → index).</p>
<p><strong>Returns</strong>: Dictionary with <code class="docutils literal notranslate"><span class="pre">success</span></code>, <code class="docutils literal notranslate"><span class="pre">fasta_path</span></code>, <code class="docutils literal notranslate"><span class="pre">index_path</span></code>, <code class="docutils literal notranslate"><span class="pre">error</span></code> keys</p>
<p><strong>See Also</strong>: <a class="reference internal" href="amalgkit/genome_preparation.html"><span class="std std-doc">Genome Preparation</span></a></p>
</section>
<hr class="docutils" />
<section id="prepare-transcriptome-for-kallisto">
<h3><code class="docutils literal notranslate"><span class="pre">prepare_transcriptome_for_kallisto</span></code><a class="headerlink" href="#prepare-transcriptome-for-kallisto" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">prepare_transcriptome_for_kallisto</span><span class="p">(</span>
    <span class="n">genome_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">species_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">work_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">accession</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.genome_prep</span></code></p>
<p><strong>Purpose</strong>: Extract and prepare RNA FASTA file from genome package.</p>
<p><strong>Returns</strong>: Path to prepared FASTA file or None if failed</p>
</section>
<hr class="docutils" />
<section id="build-kallisto-index">
<h3><code class="docutils literal notranslate"><span class="pre">build_kallisto_index</span></code><a class="headerlink" href="#build-kallisto-index" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">build_kallisto_index</span><span class="p">(</span>
    <span class="n">fasta_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">index_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">kmer_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">31</span><span class="p">,</span>
    <span class="n">check_existing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.genome_prep</span></code></p>
<p><strong>Purpose</strong>: Build kallisto index from transcriptome FASTA.</p>
<p><strong>Parameters</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fasta_path</span></code>: Path to transcriptome FASTA file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">index_path</span></code>: Output path for kallisto index</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kmer_size</span></code>: K-mer size (31 for standard reads, 23 for short reads)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check_existing</span></code>: Skip if index already exists</p></li>
</ul>
<p><strong>Returns</strong>: True if index was built successfully or already exists</p>
</section>
<hr class="docutils" />
<section id="find-rna-fasta-in-genome-dir">
<h3><code class="docutils literal notranslate"><span class="pre">find_rna_fasta_in_genome_dir</span></code><a class="headerlink" href="#find-rna-fasta-in-genome-dir" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">find_rna_fasta_in_genome_dir</span><span class="p">(</span>
    <span class="n">genome_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">accession</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.genome_prep</span></code></p>
<p><strong>Purpose</strong>: Locate RNA FASTA file in extracted genome directory.</p>
</section>
<hr class="docutils" />
<section id="download-rna-fasta-from-ftp">
<h3><code class="docutils literal notranslate"><span class="pre">download_rna_fasta_from_ftp</span></code><a class="headerlink" href="#download-rna-fasta-from-ftp" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">download_rna_fasta_from_ftp</span><span class="p">(</span>
    <span class="n">ftp_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">genome_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">accession</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">assembly_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.genome_prep</span></code></p>
<p><strong>Purpose</strong>: Download RNA FASTA directly from NCBI FTP.</p>
</section>
<hr class="docutils" />
<section id="download-cds-fasta-from-ftp">
<h3><code class="docutils literal notranslate"><span class="pre">download_cds_fasta_from_ftp</span></code><a class="headerlink" href="#download-cds-fasta-from-ftp" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">download_cds_fasta_from_ftp</span><span class="p">(</span>
    <span class="n">ftp_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">genome_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">accession</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">assembly_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.genome_prep</span></code></p>
<p><strong>Purpose</strong>: Download CDS FASTA directly from NCBI FTP.</p>
</section>
<hr class="docutils" />
<section id="extract-transcripts-from-gff">
<h3><code class="docutils literal notranslate"><span class="pre">extract_transcripts_from_gff</span></code><a class="headerlink" href="#extract-transcripts-from-gff" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">extract_transcripts_from_gff</span><span class="p">(</span>
    <span class="n">gff_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">genome_fasta</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">output_fasta</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.genome_prep</span></code></p>
<p><strong>Purpose</strong>: Extract transcript sequences from GFF annotation using gffread.</p>
</section>
<hr class="docutils" />
<section id="get-expected-index-path">
<h3><code class="docutils literal notranslate"><span class="pre">get_expected_index_path</span></code><a class="headerlink" href="#get-expected-index-path" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_expected_index_path</span><span class="p">(</span><span class="n">work_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">species_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.genome_prep</span></code></p>
<p><strong>Purpose</strong>: Get expected kallisto index path for a species.</p>
</section>
<hr class="docutils" />
<section id="verify-genome-status">
<h3><code class="docutils literal notranslate"><span class="pre">verify_genome_status</span></code><a class="headerlink" href="#verify-genome-status" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">verify_genome_status</span><span class="p">(</span>
    <span class="n">genome_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">work_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">species_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">accession</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.genome_prep</span></code></p>
<p><strong>Purpose</strong>: Check genome download, transcriptome preparation, and index status.</p>
<p><strong>Returns</strong>: Dictionary with status flags and paths</p>
</section>
<hr class="docutils" />
<section id="orchestrate-genome-setup">
<h3><code class="docutils literal notranslate"><span class="pre">orchestrate_genome_setup</span></code><a class="headerlink" href="#orchestrate-genome-setup" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">orchestrate_genome_setup</span><span class="p">(</span>
    <span class="n">config_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;config/amalgkit&quot;</span><span class="p">),</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">species</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">skip_download</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_prepare</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_build</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.genome_prep</span></code></p>
<p><strong>Purpose</strong>: Run complete genome setup pipeline for all or specific species.</p>
<p><strong>See Also</strong>: <a class="reference internal" href="amalgkit/genome_setup_guide.html"><span class="std std-doc">Genome Setup Guide</span></a></p>
</section>
</section>
<hr class="docutils" />
<section id="orchestration-functions">
<h2>Orchestration Functions<a class="headerlink" href="#orchestration-functions" title="Link to this heading"></a></h2>
<p>Functions for managing multi-species workflows and monitoring progress.</p>
<section id="discover-species-configs">
<h3><code class="docutils literal notranslate"><span class="pre">discover_species_configs</span></code><a class="headerlink" href="#discover-species-configs" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">discover_species_configs</span><span class="p">(</span>
    <span class="n">config_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;config/amalgkit&quot;</span><span class="p">)</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.orchestration</span></code></p>
<p><strong>Purpose</strong>: Discover all species configuration files in config directory.</p>
<p><strong>Returns</strong>: Dictionary mapping species names to config dictionaries</p>
</section>
<hr class="docutils" />
<section id="run-workflow-for-species">
<h3><code class="docutils literal notranslate"><span class="pre">run_workflow_for_species</span></code><a class="headerlink" href="#run-workflow-for-species" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">run_workflow_for_species</span><span class="p">(</span>
    <span class="n">config_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">check</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.orchestration</span></code></p>
<p><strong>Purpose</strong>: Execute workflow steps for a single species.</p>
<p><strong>Parameters</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">config_path</span></code>: Path to species workflow config file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">steps</span></code>: List of steps to run (default: all steps)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code>: If True, stop on first failure</p></li>
</ul>
<p><strong>Returns</strong>: Dictionary with <code class="docutils literal notranslate"><span class="pre">success</span></code>, <code class="docutils literal notranslate"><span class="pre">completed</span></code>, <code class="docutils literal notranslate"><span class="pre">failed</span></code>, <code class="docutils literal notranslate"><span class="pre">return_codes</span></code> keys</p>
</section>
<hr class="docutils" />
<section id="check-workflow-status">
<h3><code class="docutils literal notranslate"><span class="pre">check_workflow_status</span></code><a class="headerlink" href="#check-workflow-status" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">check_workflow_status</span><span class="p">(</span>
    <span class="n">config_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">detailed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.orchestration</span></code></p>
<p><strong>Purpose</strong>: Check workflow status for a species. Unified interface that delegates to monitoring functions.</p>
<p><strong>Parameters</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">config_path</span></code>: Path to species workflow config file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">detailed</span></code>: If True, return detailed analysis via <code class="docutils literal notranslate"><span class="pre">analyze_species_status()</span></code>; if False, return progress summary via <code class="docutils literal notranslate"><span class="pre">check_workflow_progress()</span></code></p></li>
</ul>
<p><strong>Returns</strong>: Dictionary with status information (format depends on <code class="docutils literal notranslate"><span class="pre">detailed</span></code> parameter)</p>
<p><strong>Note</strong>: This is a convenience wrapper. For direct access:</p>
<ul class="simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">check_workflow_progress()</span></code> for progress summary</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">analyze_species_status()</span></code> for detailed analysis</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="cleanup-unquantified-samples">
<h3><code class="docutils literal notranslate"><span class="pre">cleanup_unquantified_samples</span></code><a class="headerlink" href="#cleanup-unquantified-samples" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">cleanup_unquantified_samples</span><span class="p">(</span>
    <span class="n">config_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">log_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.orchestration</span></code></p>
<p><strong>Purpose</strong>: Quantify downloaded samples and cleanup FASTQs. Finds all samples with FASTQ files but no quantification results, quantifies each sample, and deletes FASTQ files after successful quantification.</p>
<p><strong>Parameters</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">config_path</span></code>: Path to species workflow config file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">log_dir</span></code>: Optional log directory</p></li>
</ul>
<p><strong>Returns</strong>: Tuple of <code class="docutils literal notranslate"><span class="pre">(quantified_count,</span> <span class="pre">failed_count)</span></code></p>
</section>
<hr class="docutils" />
<section id="monitor-workflows">
<h3><code class="docutils literal notranslate"><span class="pre">monitor_workflows</span></code><a class="headerlink" href="#monitor-workflows" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">monitor_workflows</span><span class="p">(</span>
    <span class="n">species_configs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
    <span class="n">watch_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.orchestration</span></code></p>
<p><strong>Purpose</strong>: Real-time monitoring of multiple species workflows.</p>
<p><strong>Parameters</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">species_configs</span></code>: Dictionary mapping species_id -&gt; config_path</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">watch_interval</span></code>: Update interval in seconds (default: 60)</p></li>
</ul>
<p><strong>Note</strong>: This function runs continuously until interrupted (Ctrl+C). It displays a real-time dashboard showing progress for all monitored species.</p>
</section>
</section>
<hr class="docutils" />
<section id="utility-functions">
<h2>Utility Functions<a class="headerlink" href="#utility-functions" title="Link to this heading"></a></h2>
<p>Core utilities for CLI interaction and parameter handling.</p>
<section id="check-cli-available">
<h3><code class="docutils literal notranslate"><span class="pre">check_cli_available</span></code><a class="headerlink" href="#check-cli-available" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">check_cli_available</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.amalgkit</span></code></p>
<p><strong>Purpose</strong>: Check if <code class="docutils literal notranslate"><span class="pre">amalgkit</span></code> CLI is available on PATH.</p>
<p><strong>Returns</strong>: Tuple of <code class="docutils literal notranslate"><span class="pre">(is_available:</span> <span class="pre">bool,</span> <span class="pre">help_text_or_error:</span> <span class="pre">str)</span></code></p>
</section>
<hr class="docutils" />
<section id="ensure-cli-available">
<h3><code class="docutils literal notranslate"><span class="pre">ensure_cli_available</span></code><a class="headerlink" href="#ensure-cli-available" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ensure_cli_available</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">auto_install</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.amalgkit</span></code></p>
<p><strong>Purpose</strong>: Ensure amalgkit CLI is available, optionally attempting auto-install.</p>
<p><strong>Returns</strong>: Tuple of <code class="docutils literal notranslate"><span class="pre">(ok:</span> <span class="pre">bool,</span> <span class="pre">message:</span> <span class="pre">str,</span> <span class="pre">install_record:</span> <span class="pre">dict</span> <span class="pre">|</span> <span class="pre">None)</span></code></p>
</section>
<hr class="docutils" />
<section id="build-cli-args">
<h3><code class="docutils literal notranslate"><span class="pre">build_cli_args</span></code><a class="headerlink" href="#build-cli-args" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">build_cli_args</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">AmalgkitParams</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">for_cli</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.amalgkit</span></code></p>
<p><strong>Purpose</strong>: Convert parameter dictionary to CLI argument list.</p>
<p><strong>Parameters</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">params</span></code>: Parameter mapping</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">for_cli</span></code>: If True, use snake_case flags (for actual CLI); if False, use kebab-case (for display)</p></li>
</ul>
<p><strong>Returns</strong>: List of CLI argument strings</p>
</section>
<hr class="docutils" />
<section id="build-amalgkit-command">
<h3><code class="docutils literal notranslate"><span class="pre">build_amalgkit_command</span></code><a class="headerlink" href="#build-amalgkit-command" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">build_amalgkit_command</span><span class="p">(</span>
    <span class="n">subcommand</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">AmalgkitParams</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.amalgkit</span></code></p>
<p><strong>Purpose</strong>: Build complete amalgkit command as token list.</p>
<p><strong>Example</strong>: <code class="docutils literal notranslate"><span class="pre">build_amalgkit_command(&quot;metadata&quot;,</span> <span class="pre">{&quot;threads&quot;:</span> <span class="pre">8})</span></code> → <code class="docutils literal notranslate"><span class="pre">[&quot;amalgkit&quot;,</span> <span class="pre">&quot;metadata&quot;,</span> <span class="pre">&quot;--threads&quot;,</span> <span class="pre">&quot;8&quot;]</span></code></p>
</section>
<hr class="docutils" />
<section id="run-amalgkit">
<h3><code class="docutils literal notranslate"><span class="pre">run_amalgkit</span></code><a class="headerlink" href="#run-amalgkit" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">run_amalgkit</span><span class="p">(</span>
    <span class="n">subcommand</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">AmalgkitParams</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">work_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">env</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">check</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">capture_output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">log_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">step_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CompletedProcess</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.amalgkit</span></code></p>
<p><strong>Purpose</strong>: Execute amalgkit subcommand with optional logging and directory management.</p>
<p><strong>Parameters</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">subcommand</span></code>: Amalgkit subcommand name (e.g., “metadata”, “quant”)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">params</span></code>: Parameter dictionary</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">work_dir</span></code>: Working directory (created if missing)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">env</span></code>: Additional environment variables</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code>: Raise exception on non-zero exit</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">capture_output</span></code>: Capture stdout/stderr</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">log_dir</span></code>: Directory for timestamped log files</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">step_name</span></code>: Optional label for log filenames</p></li>
</ul>
<p><strong>Returns</strong>: <code class="docutils literal notranslate"><span class="pre">subprocess.CompletedProcess[str]</span></code> with execution results</p>
</section>
</section>
<hr class="docutils" />
<section id="processing-functions">
<h2>Processing Functions<a class="headerlink" href="#processing-functions" title="Link to this heading"></a></h2>
<p>Functions for sample-level processing pipelines.</p>
<section id="quantify-sample">
<h3><code class="docutils literal notranslate"><span class="pre">quantify_sample</span></code><a class="headerlink" href="#quantify-sample" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">quantify_sample</span><span class="p">(</span>
    <span class="n">sample_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">metadata_rows</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
    <span class="n">quant_params</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">log_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">step_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.steps.quant</span></code></p>
<p><strong>Purpose</strong>: Quantify a single sample using amalgkit quant.</p>
<p><strong>Returns</strong>: Tuple of <code class="docutils literal notranslate"><span class="pre">(success:</span> <span class="pre">bool,</span> <span class="pre">message:</span> <span class="pre">str,</span> <span class="pre">abundance_file:</span> <span class="pre">Path</span> <span class="pre">|</span> <span class="pre">None)</span></code></p>
</section>
<hr class="docutils" />
<section id="convert-sra-to-fastq">
<h3><code class="docutils literal notranslate"><span class="pre">convert_sra_to_fastq</span></code><a class="headerlink" href="#convert-sra-to-fastq" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">convert_sra_to_fastq</span><span class="p">(</span>
    <span class="n">sample_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">sra_file</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">output_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">threads</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
    <span class="n">log_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Path</span><span class="p">]]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.steps.getfastq</span></code></p>
<p><strong>Purpose</strong>: Convert a local SRA file to FASTQ format. Prefers <code class="docutils literal notranslate"><span class="pre">parallel-fastq-dump</span></code> (works better with local files) and falls back to <code class="docutils literal notranslate"><span class="pre">fasterq-dump</span></code> if needed. Automatically compresses output FASTQ files.</p>
<p><strong>Args</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sample_id</span></code>: SRA accession ID (e.g., “SRR1234567”)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sra_file</span></code>: Path to the SRA file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">output_dir</span></code>: Directory where FASTQ files should be written</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">threads</span></code>: Number of threads for conversion (default: 4)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">log_dir</span></code>: Optional directory for log files</p></li>
</ul>
<p><strong>Returns</strong>: Tuple of <code class="docutils literal notranslate"><span class="pre">(success:</span> <span class="pre">bool,</span> <span class="pre">message:</span> <span class="pre">str,</span> <span class="pre">fastq_files:</span> <span class="pre">list[Path])</span></code>. <code class="docutils literal notranslate"><span class="pre">fastq_files</span></code> contains paths to created FASTQ files (may be empty if failed).</p>
<p><strong>Notes</strong>:</p>
<ul class="simple">
<li><p>Automatically detects and uses the real <code class="docutils literal notranslate"><span class="pre">fasterq-dump</span></code> binary (not wrapper scripts)</p></li>
<li><p>Passes <code class="docutils literal notranslate"><span class="pre">--size-check</span> <span class="pre">off</span></code> to <code class="docutils literal notranslate"><span class="pre">fasterq-dump</span></code> to prevent “disk-limit exceeded” errors</p></li>
<li><p>Automatically compresses output using <code class="docutils literal notranslate"><span class="pre">pigz</span></code> or <code class="docutils literal notranslate"><span class="pre">gzip</span></code></p></li>
<li><p>Checks for existing FASTQ files before conversion</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="delete-sample-fastqs">
<h3><code class="docutils literal notranslate"><span class="pre">delete_sample_fastqs</span></code><a class="headerlink" href="#delete-sample-fastqs" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">delete_sample_fastqs</span><span class="p">(</span>
    <span class="n">sample_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">fastq_dir</span><span class="p">:</span> <span class="n">Path</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.steps.getfastq</span></code></p>
<p><strong>Purpose</strong>: Delete FASTQ files for a specific sample.</p>
</section>
<hr class="docutils" />
<section id="run-download-quant-workflow">
<h3><code class="docutils literal notranslate"><span class="pre">run_download_quant_workflow</span></code><a class="headerlink" href="#run-download-quant-workflow" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">run_download_quant_workflow</span><span class="p">(</span>
    <span class="n">metadata_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">getfastq_params</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">quant_params</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">work_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">log_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">num_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">max_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">skip_completed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">progress_monitor</span><span class="p">:</span> <span class="n">DownloadProgressMonitor</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.steps.process_samples</span></code></p>
<p><strong>Purpose</strong>: Unified function for download-quantify-delete workflows. Supports both sequential and parallel processing modes.</p>
<p><strong>Parameters</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">metadata_path</span></code>: Path to metadata TSV with sample list</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">getfastq_params</span></code>: Parameters for amalgkit getfastq step</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">quant_params</span></code>: Parameters for amalgkit quant step</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">work_dir</span></code>: Working directory for amalgkit commands</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">log_dir</span></code>: Directory for step logs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_workers</span></code>: Number of parallel download workers (default: 1 for sequential mode)</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">num_workers=1</span></code>: Sequential mode (one sample at a time, maximum disk efficiency)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_workers&gt;1</span></code>: Parallel mode (N downloads in parallel, sequential quantification)</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_samples</span></code>: Optional limit on number of samples to process</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">skip_completed</span></code>: If True, skip samples that are already quantified (sequential mode only)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">progress_monitor</span></code>: Optional progress monitor for tracking downloads</p></li>
</ul>
<p><strong>Returns</strong>: Dictionary with processing statistics:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">total_samples</span></code>: Total number of samples</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">processed</span></code>: Number of samples successfully processed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">skipped</span></code>: Number of samples skipped (already done)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">failed</span></code>: Number of samples that failed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">failed_runs</span></code>: List of run IDs that failed</p></li>
</ul>
<p><strong>Processing Modes</strong>:</p>
<ul class="simple">
<li><p><strong>Sequential</strong> (<code class="docutils literal notranslate"><span class="pre">num_workers=1</span></code>): Process one sample at a time. Maximum disk efficiency: only one sample’s FASTQs exist at a time.</p></li>
<li><p><strong>Parallel</strong> (<code class="docutils literal notranslate"><span class="pre">num_workers&gt;1</span></code>): Multiple download workers fetch FASTQ files in parallel, then a single quantification worker processes them sequentially. Maximizes throughput while preventing disk exhaustion.</p></li>
</ul>
<p><strong>See Also</strong>: <a class="reference internal" href="ARCHITECTURE.html#processing-workflows"><span class="std std-ref">Architecture Documentation</span></a></p>
</section>
</section>
<hr class="docutils" />
<section id="type-definitions">
<h2>Type Definitions<a class="headerlink" href="#type-definitions" title="Link to this heading"></a></h2>
<section id="amalgkitparams">
<h3><code class="docutils literal notranslate"><span class="pre">AmalgkitParams</span></code><a class="headerlink" href="#amalgkitparams" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">AmalgkitParams</span> <span class="o">=</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.amalgkit</span></code></p>
<p><strong>Purpose</strong>: Type alias for amalgkit parameter dictionaries.</p>
</section>
</section>
<hr class="docutils" />
<section id="monitoring-functions">
<h2>Monitoring Functions<a class="headerlink" href="#monitoring-functions" title="Link to this heading"></a></h2>
<p>Functions for tracking workflow progress and sample status.</p>
<section id="count-quantified-samples">
<h3><code class="docutils literal notranslate"><span class="pre">count_quantified_samples</span></code><a class="headerlink" href="#count-quantified-samples" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">count_quantified_samples</span><span class="p">(</span><span class="n">config_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.monitoring</span></code></p>
<p><strong>Purpose</strong>: Count quantified and total samples for a species.</p>
<p><strong>Returns</strong>: Tuple of <code class="docutils literal notranslate"><span class="pre">(quantified_count,</span> <span class="pre">total_count)</span></code></p>
</section>
<hr class="docutils" />
<section id="get-sample-status">
<h3><code class="docutils literal notranslate"><span class="pre">get_sample_status</span></code><a class="headerlink" href="#get-sample-status" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_sample_status</span><span class="p">(</span><span class="n">config_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">sample_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.monitoring</span></code></p>
<p><strong>Purpose</strong>: Get detailed status for a single sample.</p>
<p><strong>Returns</strong>: Dictionary with status information:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">quantified</span></code>: bool</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">has_fastq</span></code>: bool</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">has_sra</span></code>: bool</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">is_downloading</span></code>: bool</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">status</span></code>: str (“quantified”, “downloading”, “has_fastq”, “has_sra”, “undownloaded”)</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="analyze-species-status">
<h3><code class="docutils literal notranslate"><span class="pre">analyze_species_status</span></code><a class="headerlink" href="#analyze-species-status" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">analyze_species_status</span><span class="p">(</span><span class="n">config_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.monitoring</span></code></p>
<p><strong>Purpose</strong>: Comprehensive analysis of species workflow status.</p>
<p><strong>Returns</strong>: Dictionary with comprehensive status information:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">total_in_metadata</span></code>: int</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">quantified</span></code>: int</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">quantified_and_deleted</span></code>: int</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">quantified_not_deleted</span></code>: int</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">downloading</span></code>: int</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">failed_download</span></code>: int</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">undownloaded</span></code>: int</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">categories</span></code>: dict mapping category -&gt; list of sample_ids</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="find-unquantified-samples">
<h3><code class="docutils literal notranslate"><span class="pre">find_unquantified_samples</span></code><a class="headerlink" href="#find-unquantified-samples" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">find_unquantified_samples</span><span class="p">(</span><span class="n">config_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.monitoring</span></code></p>
<p><strong>Purpose</strong>: Find all unquantified samples.</p>
<p><strong>Returns</strong>: List of sample IDs that are not quantified</p>
</section>
<hr class="docutils" />
<section id="check-active-downloads">
<h3><code class="docutils literal notranslate"><span class="pre">check_active_downloads</span></code><a class="headerlink" href="#check-active-downloads" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">check_active_downloads</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.monitoring</span></code></p>
<p><strong>Purpose</strong>: Check for samples currently being downloaded.</p>
<p><strong>Returns</strong>: Set of sample IDs that are actively downloading</p>
</section>
<hr class="docutils" />
<section id="check-workflow-progress">
<h3><code class="docutils literal notranslate"><span class="pre">check_workflow_progress</span></code><a class="headerlink" href="#check-workflow-progress" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">check_workflow_progress</span><span class="p">(</span><span class="n">config_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.monitoring</span></code></p>
<p><strong>Purpose</strong>: Get workflow progress summary for a species.</p>
<p><strong>Returns</strong>: Dictionary with progress information:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">quantified</span></code>: int</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">total</span></code>: int</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">percentage</span></code>: float</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">remaining</span></code>: int</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">downloading</span></code>: int (number of samples currently downloading)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">has_files</span></code>: int (number of samples with downloaded files but not quantified)</p></li>
</ul>
<p><strong>Note</strong>: This is called by <code class="docutils literal notranslate"><span class="pre">check_workflow_status()</span></code> when <code class="docutils literal notranslate"><span class="pre">detailed=False</span></code>. Use <code class="docutils literal notranslate"><span class="pre">check_workflow_status()</span></code> for the unified interface.</p>
</section>
<hr class="docutils" />
<section id="assess-all-species-progress">
<h3><code class="docutils literal notranslate"><span class="pre">assess_all_species_progress</span></code><a class="headerlink" href="#assess-all-species-progress" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">assess_all_species_progress</span><span class="p">(</span>
    <span class="n">config_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">repo_root</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.monitoring</span></code></p>
<p><strong>Purpose</strong>: Assess progress for all species in config directory.</p>
<p><strong>Returns</strong>: Dictionary mapping species_id -&gt; progress information</p>
</section>
<hr class="docutils" />
<section id="initialize-progress-tracking">
<h3><code class="docutils literal notranslate"><span class="pre">initialize_progress_tracking</span></code><a class="headerlink" href="#initialize-progress-tracking" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">initialize_progress_tracking</span><span class="p">(</span>
    <span class="n">config_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">tracker</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.monitoring</span></code></p>
<p><strong>Purpose</strong>: Initialize progress tracking for a species.</p>
<p><strong>Returns</strong>: Dictionary with initialization results</p>
</section>
</section>
<hr class="docutils" />
<section id="environment-functions">
<h2>Environment Functions<a class="headerlink" href="#environment-functions" title="Link to this heading"></a></h2>
<p>Functions for checking tool availability and environment validation.</p>
<section id="check-amalgkit">
<h3><code class="docutils literal notranslate"><span class="pre">check_amalgkit</span></code><a class="headerlink" href="#check-amalgkit" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">check_amalgkit</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.environment</span></code></p>
<p><strong>Purpose</strong>: Check if amalgkit is available and get version.</p>
<p><strong>Returns</strong>: Tuple of <code class="docutils literal notranslate"><span class="pre">(is_available:</span> <span class="pre">bool,</span> <span class="pre">message:</span> <span class="pre">str)</span></code></p>
</section>
<hr class="docutils" />
<section id="check-sra-toolkit">
<h3><code class="docutils literal notranslate"><span class="pre">check_sra_toolkit</span></code><a class="headerlink" href="#check-sra-toolkit" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">check_sra_toolkit</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.environment</span></code></p>
<p><strong>Purpose</strong>: Check if SRA Toolkit is installed.</p>
<p><strong>Returns</strong>: Tuple of <code class="docutils literal notranslate"><span class="pre">(is_available:</span> <span class="pre">bool,</span> <span class="pre">message:</span> <span class="pre">str)</span></code></p>
</section>
<hr class="docutils" />
<section id="check-kallisto">
<h3><code class="docutils literal notranslate"><span class="pre">check_kallisto</span></code><a class="headerlink" href="#check-kallisto" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">check_kallisto</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.environment</span></code></p>
<p><strong>Purpose</strong>: Check if kallisto is installed.</p>
<p><strong>Returns</strong>: Tuple of <code class="docutils literal notranslate"><span class="pre">(is_available:</span> <span class="pre">bool,</span> <span class="pre">message:</span> <span class="pre">str)</span></code></p>
</section>
<hr class="docutils" />
<section id="check-metainformant">
<h3><code class="docutils literal notranslate"><span class="pre">check_metainformant</span></code><a class="headerlink" href="#check-metainformant" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">check_metainformant</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.environment</span></code></p>
<p><strong>Purpose</strong>: Check if metainformant package is installed.</p>
<p><strong>Returns</strong>: Tuple of <code class="docutils literal notranslate"><span class="pre">(is_available:</span> <span class="pre">bool,</span> <span class="pre">message:</span> <span class="pre">str)</span></code></p>
</section>
<hr class="docutils" />
<section id="check-virtual-env">
<h3><code class="docutils literal notranslate"><span class="pre">check_virtual_env</span></code><a class="headerlink" href="#check-virtual-env" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">check_virtual_env</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.environment</span></code></p>
<p><strong>Purpose</strong>: Check if running inside a virtual environment.</p>
<p><strong>Returns</strong>: Tuple of <code class="docutils literal notranslate"><span class="pre">(is_in_venv:</span> <span class="pre">bool,</span> <span class="pre">message:</span> <span class="pre">str)</span></code></p>
</section>
<hr class="docutils" />
<section id="check-rscript">
<h3><code class="docutils literal notranslate"><span class="pre">check_rscript</span></code><a class="headerlink" href="#check-rscript" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">check_rscript</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.environment</span></code></p>
<p><strong>Purpose</strong>: Check if Rscript is available.</p>
<p><strong>Returns</strong>: Tuple of <code class="docutils literal notranslate"><span class="pre">(is_available:</span> <span class="pre">bool,</span> <span class="pre">message:</span> <span class="pre">str)</span></code></p>
</section>
<hr class="docutils" />
<section id="check-dependencies">
<h3><code class="docutils literal notranslate"><span class="pre">check_dependencies</span></code><a class="headerlink" href="#check-dependencies" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">check_dependencies</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.environment</span></code></p>
<p><strong>Purpose</strong>: Check all required dependencies for RNA-seq workflows.</p>
<p><strong>Returns</strong>: Dictionary mapping dependency name -&gt; <code class="docutils literal notranslate"><span class="pre">(is_available:</span> <span class="pre">bool,</span> <span class="pre">message:</span> <span class="pre">str)</span></code></p>
</section>
<hr class="docutils" />
<section id="validate-environment">
<h3><code class="docutils literal notranslate"><span class="pre">validate_environment</span></code><a class="headerlink" href="#validate-environment" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">validate_environment</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.environment</span></code></p>
<p><strong>Purpose</strong>: Comprehensive environment validation.</p>
<p><strong>Returns</strong>: Dictionary with validation results:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">all_passed</span></code>: bool</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dependencies</span></code>: dict mapping name -&gt; <code class="docutils literal notranslate"><span class="pre">(is_available,</span> <span class="pre">message)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">recommendations</span></code>: list of strings with recommendations</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="cleanup-functions">
<h2>Cleanup Functions<a class="headerlink" href="#cleanup-functions" title="Link to this heading"></a></h2>
<p>Functions for cleaning up partial downloads and fixing file naming issues.</p>
<section id="cleanup-partial-downloads">
<h3><code class="docutils literal notranslate"><span class="pre">cleanup_partial_downloads</span></code><a class="headerlink" href="#cleanup-partial-downloads" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">cleanup_partial_downloads</span><span class="p">(</span>
    <span class="n">config_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">dry_run</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.cleanup</span></code></p>
<p><strong>Purpose</strong>: Clean up partial downloads for a species.</p>
<p><strong>Parameters</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">config_path</span></code>: Path to species workflow config file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dry_run</span></code>: If True, only report what would be deleted</p></li>
</ul>
<p><strong>Returns</strong>: Dictionary with <code class="docutils literal notranslate"><span class="pre">deleted</span></code>, <code class="docutils literal notranslate"><span class="pre">freed_mb</span></code>, <code class="docutils literal notranslate"><span class="pre">errors</span></code> keys</p>
</section>
<hr class="docutils" />
<section id="fix-abundance-naming">
<h3><code class="docutils literal notranslate"><span class="pre">fix_abundance_naming</span></code><a class="headerlink" href="#fix-abundance-naming" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">fix_abundance_naming</span><span class="p">(</span><span class="n">quant_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">sample_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.cleanup</span></code></p>
<p><strong>Purpose</strong>: Create symlink from <code class="docutils literal notranslate"><span class="pre">abundance.tsv</span></code> to <code class="docutils literal notranslate"><span class="pre">{SRR}_abundance.tsv</span></code> for amalgkit merge.</p>
<p><strong>Parameters</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">quant_dir</span></code>: Directory containing quantification results</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample_id</span></code>: Sample ID (e.g., ‘SRR1234567’)</p></li>
</ul>
<p><strong>Returns</strong>: True if symlink was created or already exists</p>
</section>
<hr class="docutils" />
<section id="fix-abundance-naming-for-species">
<h3><code class="docutils literal notranslate"><span class="pre">fix_abundance_naming_for_species</span></code><a class="headerlink" href="#fix-abundance-naming-for-species" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">fix_abundance_naming_for_species</span><span class="p">(</span>
    <span class="n">config_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.cleanup</span></code></p>
<p><strong>Purpose</strong>: Fix abundance naming for all samples in a species.</p>
<p><strong>Returns</strong>: Tuple of <code class="docutils literal notranslate"><span class="pre">(created_count,</span> <span class="pre">already_exists_count)</span></code></p>
</section>
</section>
<hr class="docutils" />
<section id="discovery-functions">
<h2>Discovery Functions<a class="headerlink" href="#discovery-functions" title="Link to this heading"></a></h2>
<p>Functions for discovering species with RNA-seq data and generating configurations.</p>
<section id="search-species-with-rnaseq">
<h3><code class="docutils literal notranslate"><span class="pre">search_species_with_rnaseq</span></code><a class="headerlink" href="#search-species-with-rnaseq" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">search_species_with_rnaseq</span><span class="p">(</span>
    <span class="n">search_query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">max_records</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.discovery</span></code></p>
<p><strong>Purpose</strong>: Search NCBI SRA for species with RNA-seq data.</p>
<p><strong>Parameters</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">search_query</span></code>: NCBI Entrez search query</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_records</span></code>: Maximum number of records to retrieve</p></li>
</ul>
<p><strong>Returns</strong>: Dictionary mapping species names to metadata</p>
<p><strong>Raises</strong>: <code class="docutils literal notranslate"><span class="pre">ImportError</span></code> if Biopython is not available</p>
</section>
<hr class="docutils" />
<section id="get-genome-info">
<h3><code class="docutils literal notranslate"><span class="pre">get_genome_info</span></code><a class="headerlink" href="#get-genome-info" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_genome_info</span><span class="p">(</span><span class="n">taxonomy_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">species_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.discovery</span></code></p>
<p><strong>Purpose</strong>: Get genome assembly information for a species.</p>
<p><strong>Parameters</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">taxonomy_id</span></code>: NCBI taxonomy ID</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">species_name</span></code>: Scientific name</p></li>
</ul>
<p><strong>Returns</strong>: Genome information dictionary or None</p>
</section>
<hr class="docutils" />
<section id="generate-config-yaml">
<h3><code class="docutils literal notranslate"><span class="pre">generate_config_yaml</span></code><a class="headerlink" href="#generate-config-yaml" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">generate_config_yaml</span><span class="p">(</span>
    <span class="n">species_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">species_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">genome_info</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">repo_root</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</pre></div>
</div>
<p><strong>Module</strong>: <code class="docutils literal notranslate"><span class="pre">metainformant.rna.discovery</span></code></p>
<p><strong>Purpose</strong>: Generate amalgkit YAML configuration for a species.</p>
<p><strong>Parameters</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">species_name</span></code>: Scientific name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">species_data</span></code>: RNA-seq metadata</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">genome_info</span></code>: Genome assembly metadata (optional)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">repo_root</span></code>: Repository root directory for paths (optional)</p></li>
</ul>
<p><strong>Returns</strong>: YAML configuration string</p>
</section>
</section>
<hr class="docutils" />
<section id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="amalgkit/FUNCTIONS.html"><span class="std std-doc">Function Index</span></a> - Quick reference table</p></li>
<li><p><a class="reference internal" href="amalgkit/steps/README.html"><span class="std std-doc">Step Documentation</span></a> - Detailed step guides</p></li>
<li><p><a class="reference internal" href="workflow.html"><span class="std std-doc">Workflow Guide</span></a> - Workflow planning and execution</p></li>
<li><p><a class="reference internal" href="CONFIGURATION.html"><span class="std std-doc">Configuration Guide</span></a> - Configuration management</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, METAINFORMANT Contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>