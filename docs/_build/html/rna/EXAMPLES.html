

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RNA Workflow Examples &mdash; METAINFORMANT 0.2.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=938c9ccc"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >

          
          
          <a href="../index.html" class="icon icon-home">
            METAINFORMANT
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dna/index.html">DNA: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">RNA: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../protein/index.html">Protein: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gwas/index.html">GWAS (Genome-Wide Association Studies)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../epigenome/index.html">Epigenome: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../epigenome/index.html#key-components">Key Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../epigenome/index.html#integration-with-genomics">Integration with Genomics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../epigenome/index.html#analysis-workflows">Analysis Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../epigenome/index.html#planned-extensions">Planned Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ontology/index.html">Ontology Module Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../phenotype/index.html">Phenotype: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ecology/index.html">Ecology: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ecology/index.html#key-components">Key Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ecology/index.html#analysis-workflows">Analysis Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ecology/index.html#integration-with-other-modules">Integration with Other Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ecology/index.html#planned-extensions">Planned Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/index.html">Math: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ml/index.html">Machine Learning: Biological Data Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../networks/index.html">Networks: Biological Network Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../singlecell/index.html">Single-Cell Genomics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quality/index.html">Quality Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../visualization/index.html">Visualization: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../simulation/index.html">Simulation: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../life_events/index.html">Life Events Module</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../testing.html">Testing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980B9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">METAINFORMANT</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">RNA Workflow Examples</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/rna/EXAMPLES.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="rna-workflow-examples">
<h1>RNA Workflow Examples<a class="headerlink" href="#rna-workflow-examples" title="Link to this heading">ïƒ</a></h1>
<p>This document collects narrative walkthroughs and quick references for running METAINFORMANT RNA workflows in real-world settings.</p>
<section id="example-overview">
<h2>Example Overview<a class="headerlink" href="#example-overview" title="Link to this heading">ïƒ</a></h2>
<p>METAINFORMANT RNA workflows support complete end-to-end transcriptomic analysis from raw SRA data to publication-ready results. This document provides real-world examples demonstrating:</p>
<ul class="simple">
<li><p>Complete analysis workflows</p></li>
<li><p>Configuration patterns</p></li>
<li><p>Troubleshooting approaches</p></li>
<li><p>Best practices</p></li>
</ul>
</section>
<section id="complete-analysis-example-pogonomyrmex-barbatus">
<h2>Complete Analysis Example: Pogonomyrmex barbatus<a class="headerlink" href="#complete-analysis-example-pogonomyrmex-barbatus" title="Link to this heading">ïƒ</a></h2>
<p><strong>Date</strong>: October 28, 2025<br />
<strong>Species</strong>: <em>Pogonomyrmex barbatus</em> (red harvester ant)<br />
<strong>Tissue</strong>: Brain<br />
<strong>Directory</strong>: <code class="docutils literal notranslate"><span class="pre">output/amalgkit/pbarbatus/</span></code></p>
<section id="directory-structure">
<h3>Directory Structure<a class="headerlink" href="#directory-structure" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>output/amalgkit/pbarbatus/
â”œâ”€â”€ work/
â”‚   â”œâ”€â”€ metadata/
â”‚   â”‚   â””â”€â”€ metadata.tsv              # 83 samples discovered from NCBI SRA
â”‚   â”œâ”€â”€ index/
â”‚   â”‚   â””â”€â”€ Pogonomyrmex_barbatus.idx # Kallisto index (20.3MB, ready to use)
â”‚   â”œâ”€â”€ fasta/
â”‚   â”‚   â””â”€â”€ Pogonomyrmex_barbatus.fasta # Transcriptome reference (51.3MB)
â”‚   â””â”€â”€ quant/
â”‚       â”œâ”€â”€ SRR14740487/              # Quantified sample 1
â”‚       â”‚   â””â”€â”€ abundance.tsv         # Gene expression values (826KB)
â”‚       â””â”€â”€ SRR14740488/              # Quantified sample 2
â”‚           â””â”€â”€ abundance.tsv         # Gene expression values (828KB)
â”œâ”€â”€ genome/                           # P. barbatus genome reference
â”œâ”€â”€ fastq/                            # Downloaded FASTQ files (cleaned after quant)
â”œâ”€â”€ logs/                             # Pipeline logs
â””â”€â”€ merged/                           # Merged expression matrix (after all samples)
</pre></div>
</div>
</section>
<section id="current-status">
<h3>Current Status<a class="headerlink" href="#current-status" title="Link to this heading">ïƒ</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Component</p></th>
<th class="head"><p>Status</p></th>
<th class="head"><p>Details</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Metadata</strong></p></td>
<td><p>âœ… Complete</p></td>
<td><p>83 samples from NCBI SRA</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Genome Reference</strong></p></td>
<td><p>âœ… Downloaded</p></td>
<td><p>GCF_000187915.1</p></td>
</tr>
<tr class="row-even"><td><p><strong>Transcriptome</strong></p></td>
<td><p>âœ… Prepared</p></td>
<td><p>20,672 transcripts</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Kallisto Index</strong></p></td>
<td><p>âœ… Built</p></td>
<td><p>Ready for quantification</p></td>
</tr>
<tr class="row-even"><td><p><strong>Samples Downloaded</strong></p></td>
<td><p>2/83 (2.4%)</p></td>
<td><p>SRR14740487, SRR14740488</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Samples Quantified</strong></p></td>
<td><p>2/83 (2.4%)</p></td>
<td><p>~90% expression rate</p></td>
</tr>
<tr class="row-even"><td><p><strong>Expression Matrix</strong></p></td>
<td><p>â¹ï¸ Pending</p></td>
<td><p>Need all 83 samples</p></td>
</tr>
</tbody>
</table>
</section>
<section id="completed-samples">
<h3>Completed Samples<a class="headerlink" href="#completed-samples" title="Link to this heading">ïƒ</a></h3>
<section id="srr14740487-brain-sample-1">
<h4>SRR14740487 (Brain Sample 1)<a class="headerlink" href="#srr14740487-brain-sample-1" title="Link to this heading">ïƒ</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Location:   output/amalgkit/pbarbatus/work/quant/SRR14740487/abundance.tsv
Transcripts: 20,672 total, 18,592 expressed (89.9%)
Reads:       26,078,116 processed, 16,838,576 mapped (64.6%)
Quality:     âœ… Excellent mapping and expression rates

Top 3 genes:
  1. XM_011631231.1 - TPM: 24,372.3
  2. XM_011648336.2 - TPM:  8,560.4
  3. XM_025219454.1 - TPM:  4,694.1
</pre></div>
</div>
</section>
<section id="srr14740488-brain-sample-2">
<h4>SRR14740488 (Brain Sample 2)<a class="headerlink" href="#srr14740488-brain-sample-2" title="Link to this heading">ïƒ</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Location:   output/amalgkit/pbarbatus/work/quant/SRR14740488/abundance.tsv
Transcripts: 20,672 total, 18,719 expressed (90.6%)
Reads:       27,085,159 processed, 17,828,830 mapped (65.8%)
Quality:     âœ… Excellent mapping and expression rates

Top 3 genes:
  1. XM_011631231.1 - TPM: 29,342.9
  2. XM_011632595.2 - TPM: 28,000.0
  3. XM_011648336.2 - TPM: 10,236.0
</pre></div>
</div>
</section>
</section>
<section id="processing-remaining-samples">
<h3>Processing Remaining Samples<a class="headerlink" href="#processing-remaining-samples" title="Link to this heading">ïƒ</a></h3>
<p><strong>Recommended</strong>: Use <code class="docutils literal notranslate"><span class="pre">run_workflow.py</span></code> for complete end-to-end execution:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Full end-to-end workflow (all steps)</span>
python3<span class="w"> </span>scripts/rna/run_workflow.py<span class="w"> </span>config/amalgkit/amalgkit_pogonomyrmex_barbatus.yaml

<span class="c1"># Check status at any time</span>
python3<span class="w"> </span>scripts/rna/run_workflow.py<span class="w"> </span>config/amalgkit/amalgkit_pogonomyrmex_barbatus.yaml<span class="w"> </span>--status
</pre></div>
</div>
<p>The workflow automatically:</p>
<ul class="simple">
<li><p>Downloads remaining samples</p></li>
<li><p>Quantifies each sample immediately</p></li>
<li><p>Deletes FASTQs after quantification</p></li>
<li><p>Merges all samples into expression matrix</p></li>
</ul>
</section>
<section id="after-all-samples-quantified">
<h3>After All Samples Quantified<a class="headerlink" href="#after-all-samples-quantified" title="Link to this heading">ïƒ</a></h3>
<section id="merge-into-expression-matrix">
<h4>Merge into Expression Matrix<a class="headerlink" href="#merge-into-expression-matrix" title="Link to this heading">ïƒ</a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>output/amalgkit/pbarbatus
amalgkit<span class="w"> </span>merge<span class="w"> </span>--out_dir<span class="w"> </span>work
</pre></div>
</div>
<p>This will create:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>output/amalgkit/pbarbatus/work/merge/Pogonomyrmex_barbatus/
â”œâ”€â”€ Pogonomyrmex_barbatus_tc.tsv    # Estimated counts matrix
â”œâ”€â”€ Pogonomyrmex_barbatus_tpm.tsv   # TPM-normalized matrix
â””â”€â”€ Pogonomyrmex_barbatus_eff_len.tsv # Effective lengths
</pre></div>
</div>
<p><strong>Format</strong>: One row per transcript, one column per sample, TPM-normalized values</p>
</section>
</section>
<section id="accessing-expression-data">
<h3>Accessing Expression Data<a class="headerlink" href="#accessing-expression-data" title="Link to this heading">ïƒ</a></h3>
<section id="load-individual-samples">
<h4>Load Individual Samples<a class="headerlink" href="#load-individual-samples" title="Link to this heading">ïƒ</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="n">base</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;output/amalgkit/pbarbatus/work/quant&quot;</span><span class="p">)</span>

<span class="c1"># Load one sample</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">base</span> <span class="o">/</span> <span class="s2">&quot;SRR14740487&quot;</span> <span class="o">/</span> <span class="s2">&quot;abundance.tsv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Columns: target_id, length, eff_length, est_counts, tpm</span>
<span class="c1"># Use &#39;tpm&#39; for expression comparisons</span>
</pre></div>
</div>
</section>
<section id="load-merged-matrix-after-all-samples">
<h4>Load Merged Matrix (After All Samples)<a class="headerlink" href="#load-merged-matrix-after-all-samples" title="Link to this heading">ïƒ</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># Load merged expression matrix</span>
<span class="n">expr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;output/amalgkit/pbarbatus/work/merge/Pogonomyrmex_barbatus/Pogonomyrmex_barbatus_tpm.tsv&quot;</span><span class="p">,</span>
    <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span>  <span class="c1"># transcript_id as index</span>
<span class="p">)</span>

<span class="c1"># Shape: (20672 transcripts, 83 samples)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># Filter expressed genes (TPM &gt; 1 in at least 10% of samples)</span>
<span class="n">min_samples</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">expr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">expressed</span> <span class="o">=</span> <span class="n">expr</span><span class="p">[(</span><span class="n">expr</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">min_samples</span><span class="p">]</span>
</pre></div>
</div>
</section>
</section>
<section id="storage-management">
<h3>Storage Management<a class="headerlink" href="#storage-management" title="Link to this heading">ïƒ</a></h3>
<section id="current-usage">
<h4>Current Usage<a class="headerlink" href="#current-usage" title="Link to this heading">ïƒ</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Total directory:     599MB
â”œâ”€â”€ Metadata:        ~1MB
â”œâ”€â”€ Genome:          ~520MB
â”œâ”€â”€ Index:           20.3MB
â”œâ”€â”€ Transcriptome:   51.3MB
â”œâ”€â”€ Quantification:  2.2MB (2 samples Ã— ~1MB)
â””â”€â”€ Logs:            ~5MB
</pre></div>
</div>
</section>
<section id="after-all-83-samples">
<h4>After All 83 Samples<a class="headerlink" href="#after-all-83-samples" title="Link to this heading">ïƒ</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Expected total:      ~690MB
â”œâ”€â”€ Metadata:        ~1MB
â”œâ”€â”€ Genome:          ~520MB
â”œâ”€â”€ Index:           20.3MB
â”œâ”€â”€ Transcriptome:   51.3MB
â”œâ”€â”€ Quantification:  ~90MB (83 samples Ã— ~1MB)
â”œâ”€â”€ Merged matrix:   ~5MB
â””â”€â”€ Logs:            ~10MB

FASTQ files:         0MB (deleted after quantification)
</pre></div>
</div>
<p><strong>Key Point</strong>: FASTQs are deleted immediately after each successful quantification, keeping storage minimal.</p>
</section>
</section>
<section id="quality-metrics">
<h3>Quality Metrics<a class="headerlink" href="#quality-metrics" title="Link to this heading">ïƒ</a></h3>
<section id="mapping-rates">
<h4>Mapping Rates<a class="headerlink" href="#mapping-rates" title="Link to this heading">ïƒ</a></h4>
<ul class="simple">
<li><p><strong>Target</strong>: &gt;60% mapping rate</p></li>
<li><p><strong>Achieved</strong>: 64.6-65.8% (excellent)</p></li>
</ul>
</section>
<section id="expression-rates">
<h4>Expression Rates<a class="headerlink" href="#expression-rates" title="Link to this heading">ïƒ</a></h4>
<ul class="simple">
<li><p><strong>Target</strong>: &gt;80% of transcripts detected</p></li>
<li><p><strong>Achieved</strong>: 89.9-90.6% (excellent)</p></li>
</ul>
</section>
<section id="library-quality">
<h4>Library Quality<a class="headerlink" href="#library-quality" title="Link to this heading">ïƒ</a></h4>
<ul class="simple">
<li><p><strong>Fragment length</strong>: 234.9-236.7bp (consistent)</p></li>
<li><p><strong>Read depth</strong>: 26-27M reads per sample (good)</p></li>
</ul>
</section>
</section>
<section id="key-files-reference">
<h3>Key Files Reference<a class="headerlink" href="#key-files-reference" title="Link to this heading">ïƒ</a></h3>
<section id="metadata">
<h4>Metadata<a class="headerlink" href="#metadata" title="Link to this heading">ïƒ</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">output</span><span class="o">/</span><span class="n">amalgkit</span><span class="o">/</span><span class="n">pbarbatus</span><span class="o">/</span><span class="n">work</span><span class="o">/</span><span class="n">metadata</span><span class="o">/</span><span class="n">metadata</span><span class="o">.</span><span class="n">tsv</span>
<span class="o">-</span> <span class="mi">83</span> <span class="n">samples</span> <span class="kn">from</span><span class="w"> </span><span class="nn">NCBI</span> <span class="n">SRA</span>
<span class="o">-</span> <span class="n">Columns</span><span class="p">:</span> <span class="n">run_accession</span><span class="p">,</span> <span class="n">scientific_name</span><span class="p">,</span> <span class="n">tissue</span><span class="p">,</span> <span class="n">etc</span><span class="o">.</span>
</pre></div>
</div>
</section>
<section id="kallisto-index">
<h4>Kallisto Index<a class="headerlink" href="#kallisto-index" title="Link to this heading">ïƒ</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">output</span><span class="o">/</span><span class="n">amalgkit</span><span class="o">/</span><span class="n">pbarbatus</span><span class="o">/</span><span class="n">work</span><span class="o">/</span><span class="n">index</span><span class="o">/</span><span class="n">Pogonomyrmex_barbatus</span><span class="o">.</span><span class="n">idx</span>
<span class="o">-</span> <span class="n">Pre</span><span class="o">-</span><span class="n">built</span><span class="p">,</span> <span class="n">ready</span> <span class="k">for</span> <span class="n">quantification</span>
<span class="o">-</span> <span class="mi">20</span><span class="p">,</span><span class="mi">672</span> <span class="n">transcripts</span> <span class="n">indexed</span>
<span class="o">-</span> <span class="n">K</span><span class="o">-</span><span class="n">mer</span> <span class="n">length</span><span class="p">:</span> <span class="mi">31</span>
</pre></div>
</div>
</section>
<section id="expression-values">
<h4>Expression Values<a class="headerlink" href="#expression-values" title="Link to this heading">ïƒ</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">output</span><span class="o">/</span><span class="n">amalgkit</span><span class="o">/</span><span class="n">pbarbatus</span><span class="o">/</span><span class="n">work</span><span class="o">/</span><span class="n">quant</span><span class="o">/</span><span class="p">{</span><span class="n">sample_id</span><span class="p">}</span><span class="o">/</span><span class="n">abundance</span><span class="o">.</span><span class="n">tsv</span>
<span class="o">-</span> <span class="n">Per</span><span class="o">-</span><span class="n">sample</span> <span class="n">gene</span> <span class="n">expression</span>
<span class="o">-</span> <span class="n">Columns</span><span class="p">:</span> <span class="n">target_id</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">eff_length</span><span class="p">,</span> <span class="n">est_counts</span><span class="p">,</span> <span class="n">tpm</span>
<span class="o">-</span> <span class="n">Use</span> <span class="n">TPM</span> <span class="k">for</span> <span class="n">normalized</span> <span class="n">expression</span>
</pre></div>
</div>
</section>
<section id="merged-matrix-after-completion">
<h4>Merged Matrix (after completion)<a class="headerlink" href="#merged-matrix-after-completion" title="Link to this heading">ïƒ</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>output/amalgkit/pbarbatus/work/merge/Pogonomyrmex_barbatus/Pogonomyrmex_barbatus_tpm.tsv
- All samples in one matrix
- 20,672 rows (transcripts) Ã— 83 columns (samples)
- TPM-normalized values
</pre></div>
</div>
</section>
</section>
<section id="workflow-summary">
<h3>Workflow Summary<a class="headerlink" href="#workflow-summary" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. âœ… Metadata Discovery       [COMPLETE] 83 samples found
2. âœ… Genome Download          [COMPLETE] Reference genome
3. âœ… Transcriptome Prep       [COMPLETE] 20,672 transcripts
4. âœ… Index Building           [COMPLETE] Kallisto index ready
5. ğŸ”„ Sample Download          [2/83]     Process in batches
6. ğŸ”„ Sample Quantification    [2/83]     Using existing index
7. â¹ï¸ Merge Expression Matrix  [PENDING]  After all samples
8. â¹ï¸ Downstream Analysis      [PENDING]  DESeq2, WGCNA, etc.
</pre></div>
</div>
</section>
<section id="consolidated-folder-benefits">
<h3>Consolidated Folder Benefits<a class="headerlink" href="#consolidated-folder-benefits" title="Link to this heading">ïƒ</a></h3>
<ol class="arabic simple">
<li><p><strong>Single Source of Truth</strong>: All P. barbatus data in one place</p></li>
<li><p><strong>Organized Structure</strong>: Clear hierarchy for all pipeline stages</p></li>
<li><p><strong>Reusable Index</strong>: Built once, use for all 83 samples</p></li>
<li><p><strong>Efficient Storage</strong>: ~690MB total (vs ~360GB if keeping FASTQs)</p></li>
<li><p><strong>Ready to Scale</strong>: Validated workflow for remaining 81 samples</p></li>
</ol>
<p><strong>Status</strong>: âœ… <strong>READY FOR BATCH PROCESSING</strong><br />
<strong>Next Step</strong>: Download and quantify remaining 81 samples using existing index<br />
<strong>Estimated Time</strong>: 10-15 hours for all samples (can run overnight)</p>
</section>
</section>
<section id="usage-patterns">
<h2>Usage Patterns<a class="headerlink" href="#usage-patterns" title="Link to this heading">ïƒ</a></h2>
<section id="pattern-1-single-species-end-to-end">
<h3>Pattern 1: Single Species End-to-End<a class="headerlink" href="#pattern-1-single-species-end-to-end" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Complete workflow for one species</span>
python3<span class="w"> </span>scripts/rna/run_workflow.py<span class="w"> </span>config/amalgkit/amalgkit_pogonomyrmex_barbatus.yaml
</pre></div>
</div>
<p><strong>Use Case</strong>: Focused analysis on a single species with all samples.</p>
</section>
<section id="pattern-2-multi-species-comparative">
<h3>Pattern 2: Multi-Species Comparative<a class="headerlink" href="#pattern-2-multi-species-comparative" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Process each species separately</span>
<span class="k">for</span><span class="w"> </span>species<span class="w"> </span><span class="k">in</span><span class="w"> </span>pbarbatus<span class="w"> </span>cfloridanus<span class="w"> </span>amellifera<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span>python3<span class="w"> </span>scripts/rna/run_workflow.py<span class="w"> </span>config/amalgkit/amalgkit_<span class="si">${</span><span class="nv">species</span><span class="si">}</span>.yaml
<span class="k">done</span>

<span class="c1"># Then run cross-species analysis</span>
<span class="c1"># (See amalgkit steps: cstmm, csca)</span>
</pre></div>
</div>
<p><strong>Use Case</strong>: Comparative transcriptomics across multiple species.</p>
</section>
<section id="pattern-3-tissue-specific-analysis">
<h3>Pattern 3: Tissue-Specific Analysis<a class="headerlink" href="#pattern-3-tissue-specific-analysis" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># In config file</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="nt">require_tissue</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">tissue_types</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;brain&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;antenna&quot;</span><span class="p p-Indicator">]</span>

<span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="nt">select</span><span class="p">:</span>
<span class="w">    </span><span class="nt">sample_group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">brain,antenna</span>
</pre></div>
</div>
<p><strong>Use Case</strong>: Focused analysis on specific tissues.</p>
</section>
<section id="pattern-4-quality-filtered-analysis">
<h3>Pattern 4: Quality-Filtered Analysis<a class="headerlink" href="#pattern-4-quality-filtered-analysis" title="Link to this heading">ïƒ</a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># In config file</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="nt">min_spots</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10000000</span><span class="w">  </span><span class="c1"># Minimum 10M reads</span>
<span class="w">  </span><span class="nt">library_layout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PAIRED</span>
<span class="w">  </span><span class="nt">platform</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Illumina</span>

<span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="nt">select</span><span class="p">:</span>
<span class="w">    </span><span class="nt">min_nspots</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10000000</span>
<span class="w">    </span><span class="nt">max_sample</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
</pre></div>
</div>
<p><strong>Use Case</strong>: High-quality samples only for publication-ready analyses.</p>
</section>
</section>
<section id="maintenance">
<h2>Maintenance<a class="headerlink" href="#maintenance" title="Link to this heading">ïƒ</a></h2>
<ul class="simple">
<li><p>Update the guides whenever workflows add new steps or configuration parameters</p></li>
<li><p>Cross-link to <code class="docutils literal notranslate"><span class="pre">docs/rna/amalgkit/steps/README.md</span></code> and <code class="docutils literal notranslate"><span class="pre">docs/rna/workflow.md</span></code> when functionality changes</p></li>
<li><p>Ensure code snippets stay executable with <code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">scripts/rna/run_workflow.py</span></code></p></li>
</ul>
</section>
<section id="related-documentation">
<h2>Related Documentation<a class="headerlink" href="#related-documentation" title="Link to this heading">ïƒ</a></h2>
<ul class="simple">
<li><p><strong><a class="reference internal" href="workflow.html"><span class="std std-doc">workflow.md</span></a></strong>: Workflow planning and execution</p></li>
<li><p><strong><a class="reference internal" href="amalgkit/steps/README.html"><span class="std std-doc">amalgkit/steps/README.md</span></a></strong>: Individual step documentation</p></li>
<li><p><strong><a class="reference internal" href="CONFIGURATION.html"><span class="std std-doc">CONFIGURATION.md</span></a></strong>: Configuration management</p></li>
<li><p><strong><a class="reference internal" href="GETTING_STARTED.html"><span class="std std-doc">GETTING_STARTED.md</span></a></strong>: Setup and installation</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, METAINFORMANT Contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>