

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>amalgkit csca: Cross-Species Correlation Analysis &mdash; METAINFORMANT 0.2.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=938c9ccc"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            METAINFORMANT
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../dna/index.html">DNA: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">RNA: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../protein/index.html">Protein: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gwas/index.html">GWAS (Genome-Wide Association Studies)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../epigenome/index.html">Epigenome: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../epigenome/index.html#key-components">Key Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../epigenome/index.html#integration-with-genomics">Integration with Genomics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../epigenome/index.html#analysis-workflows">Analysis Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../epigenome/index.html#planned-extensions">Planned Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ontology/index.html">Ontology Module Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../phenotype/index.html">Phenotype: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ecology/index.html">Ecology: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ecology/index.html#key-components">Key Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ecology/index.html#analysis-workflows">Analysis Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ecology/index.html#integration-with-other-modules">Integration with Other Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ecology/index.html#planned-extensions">Planned Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../math/index.html">Math: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ml/index.html">Machine Learning: Biological Data Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../networks/index.html">Networks: Biological Network Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../singlecell/index.html">Single-Cell Genomics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quality/index.html">Quality Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../visualization/index.html">Visualization: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../simulation/index.html">Simulation: Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../life_events/index.html">Life Events Module</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../testing.html">Testing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980B9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">METAINFORMANT</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">amalgkit csca: Cross-Species Correlation Analysis</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/rna/amalgkit/steps/10_csca.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="amalgkit-csca-cross-species-correlation-analysis">
<h1>amalgkit csca: Cross-Species Correlation Analysis<a class="headerlink" href="#amalgkit-csca-cross-species-correlation-analysis" title="Link to this heading"></a></h1>
<section id="purpose">
<h2>Purpose<a class="headerlink" href="#purpose" title="Link to this heading"></a></h2>
<p>Generates comprehensive plots and statistics for cross-species correlation analysis, enabling visualization and quantification of expression similarity across multiple species. This step produces <strong>publication-ready figures</strong> for comparative transcriptomics.</p>
</section>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">csca</span></code> step:</p>
<ul class="simple">
<li><p>Computes cross-species correlation matrices</p></li>
<li><p>Generates correlation heatmaps</p></li>
<li><p>Creates PCA plots for multi-species datasets</p></li>
<li><p>Produces dendrograms showing species relationships</p></li>
<li><p>Calculates correlation statistics between species</p></li>
<li><p>Generates comprehensive visualization PDFs</p></li>
</ul>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Link to this heading"></a></h2>
<section id="basic-usage">
<h3>Basic Usage<a class="headerlink" href="#basic-usage" title="Link to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>amalgkit<span class="w"> </span>csca<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--out_dir<span class="w"> </span>output/amalgkit/work<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--metadata<span class="w"> </span>output/amalgkit/work/metadata/metadata.tsv<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--orthogroup_table<span class="w"> </span>output/orthogroups/Orthogroups.tsv<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--dir_busco<span class="w"> </span>output/busco
</pre></div>
</div>
</section>
<section id="python-api">
<h3>Python API<a class="headerlink" href="#python-api" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">metainformant.rna</span><span class="w"> </span><span class="kn">import</span> <span class="n">amalgkit</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">amalgkit</span><span class="o">.</span><span class="n">csca</span><span class="p">(</span>
    <span class="n">out_dir</span><span class="o">=</span><span class="s2">&quot;output/amalgkit/work&quot;</span><span class="p">,</span>
    <span class="n">metadata</span><span class="o">=</span><span class="s2">&quot;output/amalgkit/work/metadata/metadata.tsv&quot;</span><span class="p">,</span>
    <span class="n">orthogroup_table</span><span class="o">=</span><span class="s2">&quot;output/orthogroups/Orthogroups.tsv&quot;</span><span class="p">,</span>
    <span class="n">dir_busco</span><span class="o">=</span><span class="s2">&quot;output/busco&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="configuration-file">
<h3>Configuration File<a class="headerlink" href="#configuration-file" title="Link to this heading"></a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="nt">csca</span><span class="p">:</span>
<span class="w">    </span><span class="nt">out_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output/amalgkit/comparative</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output/amalgkit/comparative/metadata/metadata.tsv</span>
<span class="w">    </span><span class="nt">orthogroup_table</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output/orthogroups/Orthogroups.tsv</span>
<span class="w">    </span><span class="nt">dir_busco</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output/busco</span>
<span class="w">    </span><span class="nt">sample_group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">brain,liver,heart</span>
<span class="w">    </span><span class="nt">batch_effect_alg</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no</span>
</pre></div>
</div>
</section>
</section>
<section id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Link to this heading"></a></h2>
<section id="optional-parameters">
<h3>Optional Parameters<a class="headerlink" href="#optional-parameters" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--out_dir</span></code></p></td>
<td><p>PATH</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">./</span></code></p></td>
<td><p>Directory for intermediate and output files.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--metadata</span></code></p></td>
<td><p>PATH</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">inferred</span></code></p></td>
<td><p>Path to metadata.tsv. Default: <code class="docutils literal notranslate"><span class="pre">out_dir/metadata/metadata.tsv</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--sample_group</span></code></p></td>
<td><p>STR</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
<td><p>Comma-separated sample groups to analyze. Default: all groups.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--sample_group_color</span></code></p></td>
<td><p>STR</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code></p></td>
<td><p>Comma-separated hex colors for sample groups in plots.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--orthogroup_table</span></code></p></td>
<td><p>PATH</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
<td><p>Path to orthogroup table (OrthoFinder <code class="docutils literal notranslate"><span class="pre">Orthogroups.tsv</span></code>). Set to <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code> for single-species analysis.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--dir_busco</span></code></p></td>
<td><p>PATH</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
<td><p>Path to directory containing per-species BUSCO full tables.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--batch_effect_alg</span></code></p></td>
<td><p>STR</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sva</span></code></p></td>
<td><p>Batch effect algorithm used in <code class="docutils literal notranslate"><span class="pre">curate</span></code> step: <code class="docutils literal notranslate"><span class="pre">no</span></code>, <code class="docutils literal notranslate"><span class="pre">sva</span></code>, <code class="docutils literal notranslate"><span class="pre">ruvseq</span></code>, <code class="docutils literal notranslate"><span class="pre">combatseq</span></code>. Must match curation step.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="input-requirements">
<h2>Input Requirements<a class="headerlink" href="#input-requirements" title="Link to this heading"></a></h2>
<section id="prerequisites">
<h3>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Curated Expression Matrices</strong>: From <code class="docutils literal notranslate"><span class="pre">amalgkit</span> <span class="pre">curate</span></code> for each species (or <code class="docutils literal notranslate"><span class="pre">cstmm</span></code> output)</p></li>
<li><p><strong>Orthogroup Table</strong> (for cross-species): From OrthoFinder</p></li>
<li><p><strong>BUSCO Results</strong> (optional): For quality filtering</p></li>
<li><p><strong>R Environment</strong>: With visualization packages</p></li>
</ul>
</section>
<section id="expected-input-structure">
<h3>Expected Input Structure<a class="headerlink" href="#expected-input-structure" title="Link to this heading"></a></h3>
<p><strong>For Cross-Species Analysis</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>out_dir/curate/  # or out_dir/cstmm/
├── Species1/
│   └── tables/
│       └── Species1.no.tc.tsv    # Curated expression
├── Species2/
│   └── tables/
│       └── Species2.no.tc.tsv    # Curated expression
└── Species3/
    └── tables/
        └── Species3.no.tc.tsv    # Curated expression
</pre></div>
</div>
<p><strong>OR</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>out_dir/cstmm/
└── multi_species/
    └── multi_species_cstmm.tc.tsv  # TMM-normalized cross-species matrix
</pre></div>
</div>
</section>
<section id="r-dependencies">
<h3>R Dependencies<a class="headerlink" href="#r-dependencies" title="Link to this heading"></a></h3>
<p><strong>Core Packages</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ggplot2</span></code> - Plotting</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dendextend</span></code> - Dendrograms</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gplots</span></code> - Heatmaps</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">viridis</span></code> - Color palettes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pcaMethods</span></code> - PCA</p></li>
</ul>
<p><strong>Optional Packages</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Rtsne</span></code> - t-SNE visualization</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pvclust</span></code> - Hierarchical clustering with p-values</p></li>
</ul>
<p><strong>Installation</strong>: See <a class="reference internal" href="../r_packages.html"><span class="std std-doc"><code class="docutils literal notranslate"><span class="pre">../r_packages.md</span></code></span></a></p>
</section>
</section>
<section id="output-files">
<h2>Output Files<a class="headerlink" href="#output-files" title="Link to this heading"></a></h2>
<section id="directory-structure">
<h3>Directory Structure<a class="headerlink" href="#directory-structure" title="Link to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>out_dir/csca/
└── {Analysis_Name}/
    ├── plots/
    │   ├── {Analysis_Name}_correlation_heatmap.pdf     # ⭐ Correlation heatmap
    │   ├── {Analysis_Name}_pca.pdf                     # ⭐ PCA plot
    │   ├── {Analysis_Name}_dendrogram.pdf             # ⭐ Hierarchical clustering
    │   └── {Analysis_Name}_sample_correlation.pdf      # Sample correlation matrix
    ├── tables/
    │   ├── {Analysis_Name}_correlation_matrix.tsv     # Correlation values
    │   ├── {Analysis_Name}_species_summary.tsv        # Species statistics
    │   └── {Analysis_Name}_sample_info.tsv           # Sample metadata
    └── csca_summary.txt                                # Analysis summary
</pre></div>
</div>
</section>
<section id="primary-visualizations">
<h3>Primary Visualizations<a class="headerlink" href="#primary-visualizations" title="Link to this heading"></a></h3>
<p><strong>1. Correlation Heatmap (<code class="docutils literal notranslate"><span class="pre">_correlation_heatmap.pdf</span></code>)</strong></p>
<ul class="simple">
<li><p>Shows correlation between all sample pairs</p></li>
<li><p>Color-coded by correlation strength</p></li>
<li><p>Clustered by sample similarity</p></li>
<li><p>Species labels clearly marked</p></li>
</ul>
<p><strong>2. PCA Plot (<code class="docutils literal notranslate"><span class="pre">_pca.pdf</span></code>)</strong></p>
<ul class="simple">
<li><p>Principal component analysis</p></li>
<li><p>Samples colored by species and/or tissue</p></li>
<li><p>Shows separation/clustering of species</p></li>
<li><p>First 2-3 principal components</p></li>
</ul>
<p><strong>3. Dendrogram (<code class="docutils literal notranslate"><span class="pre">_dendrogram.pdf</span></code>)</strong></p>
<ul class="simple">
<li><p>Hierarchical clustering tree</p></li>
<li><p>Shows species relationships</p></li>
<li><p>Sample grouping patterns</p></li>
<li><p>Branch lengths indicate distance</p></li>
</ul>
<p><strong>4. Sample Correlation (<code class="docutils literal notranslate"><span class="pre">_sample_correlation.pdf</span></code>)</strong></p>
<ul class="simple">
<li><p>Detailed correlation matrix</p></li>
<li><p>Sample-by-sample comparisons</p></li>
<li><p>Cross-species sample relationships</p></li>
</ul>
</section>
<section id="output-tables">
<h3>Output Tables<a class="headerlink" href="#output-tables" title="Link to this heading"></a></h3>
<p><strong>Correlation Matrix (<code class="docutils literal notranslate"><span class="pre">_correlation_matrix.tsv</span></code>)</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sample1</span>              <span class="n">sample2</span>              <span class="n">correlation</span>    <span class="n">p_value</span>
<span class="n">Species1_SRR1</span>        <span class="n">Species1_SRR2</span>        <span class="mf">0.95</span>           <span class="mf">0.001</span>
<span class="n">Species1_SRR1</span>        <span class="n">Species2_SRR1</span>       <span class="mf">0.87</span>           <span class="mf">0.003</span>
<span class="n">Species2_SRR1</span>        <span class="n">Species2_SRR2</span>       <span class="mf">0.93</span>           <span class="mf">0.001</span>
</pre></div>
</div>
<p><strong>Species Summary (<code class="docutils literal notranslate"><span class="pre">_species_summary.tsv</span></code>)</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">species</span>              <span class="n">n_samples</span>    <span class="n">mean_expr</span>    <span class="n">median_expr</span>    <span class="n">cv</span>
<span class="n">Apis_mellifera</span>       <span class="mi">83</span>           <span class="mf">45.2</span>         <span class="mf">38.5</span>           <span class="mf">0.25</span>
<span class="n">Pogonomyrmex_barbatus</span>  <span class="mi">120</span>        <span class="mf">42.8</span>         <span class="mf">36.2</span>           <span class="mf">0.28</span>
</pre></div>
</div>
</section>
</section>
<section id="workflow-integration">
<h2>Workflow Integration<a class="headerlink" href="#workflow-integration" title="Link to this heading"></a></h2>
<section id="position-in-pipeline">
<h3>Position in Pipeline<a class="headerlink" href="#position-in-pipeline" title="Link to this heading"></a></h3>
<div class="highlight-mermaid notranslate"><div class="highlight"><pre><span></span>flowchart LR
    A[cstmm] --&gt; B[csca]
    C[curate] --&gt; B
    B --&gt; D[END]
</pre></div>
</div>
<p><strong>csca</strong> runs <strong>after curate or cstmm</strong>, typically as <strong>final analysis step</strong>.</p>
</section>
<section id="analysis-workflow">
<h3>Analysis Workflow<a class="headerlink" href="#analysis-workflow" title="Link to this heading"></a></h3>
<p><strong>Option 1: After Cross-Species TMM</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>merge<span class="w"> </span>→<span class="w"> </span>cstmm<span class="w"> </span>→<span class="w"> </span>csca
</pre></div>
</div>
<p><strong>Option 2: After Per-Species Curation</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>merge<span class="w"> </span>→<span class="w"> </span>curate<span class="w"> </span><span class="o">(</span>per<span class="w"> </span>species<span class="o">)</span><span class="w"> </span>→<span class="w"> </span>csca
</pre></div>
</div>
</section>
</section>
<section id="performance-considerations">
<h2>Performance Considerations<a class="headerlink" href="#performance-considerations" title="Link to this heading"></a></h2>
<section id="runtime">
<h3>Runtime<a class="headerlink" href="#runtime" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Small analysis</strong> (2-3 species, &lt;50 samples): 2-5 minutes</p></li>
<li><p><strong>Medium analysis</strong> (3-5 species, 50-200 samples): 5-15 minutes</p></li>
<li><p><strong>Large analysis</strong> (&gt;5 species, &gt;200 samples): 15-60 minutes</p></li>
</ul>
<p><strong>Factors</strong>:</p>
<ul class="simple">
<li><p>Number of species</p></li>
<li><p>Number of samples</p></li>
<li><p>Number of orthogroups/transcripts</p></li>
<li><p>R package loading time</p></li>
</ul>
</section>
<section id="memory-usage">
<h3>Memory Usage<a class="headerlink" href="#memory-usage" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Moderate</strong>: 2-8GB</p></li>
<li><p>Scales with (# genes) × (# total samples)</p></li>
</ul>
</section>
<section id="disk-space">
<h3>Disk Space<a class="headerlink" href="#disk-space" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Per analysis</strong>: 10-50MB (PDFs + tables)</p></li>
</ul>
</section>
</section>
<section id="common-use-cases">
<h2>Common Use Cases<a class="headerlink" href="#common-use-cases" title="Link to this heading"></a></h2>
<section id="cross-species-expression-comparison">
<h3>1. Cross-Species Expression Comparison<a class="headerlink" href="#cross-species-expression-comparison" title="Link to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># After cstmm normalization</span>
amalgkit<span class="w"> </span>csca<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--out_dir<span class="w"> </span>output/amalgkit/comparative<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--orthogroup_table<span class="w"> </span>output/orthogroups/Orthogroups.tsv<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--batch_effect_alg<span class="w"> </span>no
</pre></div>
</div>
<p><strong>Result</strong>: Comprehensive correlation analysis across all species</p>
</section>
<section id="tissue-specific-cross-species-analysis">
<h3>2. Tissue-Specific Cross-Species Analysis<a class="headerlink" href="#tissue-specific-cross-species-analysis" title="Link to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Brain samples only</span>
amalgkit<span class="w"> </span>csca<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--out_dir<span class="w"> </span>output/comparative_brain<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--sample_group<span class="w"> </span>brain<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--orthogroup_table<span class="w"> </span>output/orthogroups/Orthogroups.tsv
</pre></div>
</div>
<p><strong>Result</strong>: Brain-specific cross-species correlations</p>
</section>
<section id="multi-tissue-comparison">
<h3>3. Multi-Tissue Comparison<a class="headerlink" href="#multi-tissue-comparison" title="Link to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Multiple tissues</span>
amalgkit<span class="w"> </span>csca<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--out_dir<span class="w"> </span>output/comparative_multi_tissue<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--sample_group<span class="w"> </span>brain,liver,heart<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--orthogroup_table<span class="w"> </span>output/orthogroups/Orthogroups.tsv<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--sample_group_color<span class="w"> </span><span class="s2">&quot;#d95f02ff,#1b9e77ff,#7570b3ff&quot;</span>
</pre></div>
</div>
<p><strong>Result</strong>: Cross-species analysis colored by tissue type</p>
</section>
<section id="single-species-analysis-no-orthogroups">
<h3>4. Single-Species Analysis (No Orthogroups)<a class="headerlink" href="#single-species-analysis-no-orthogroups" title="Link to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Within-species correlation (no cross-species comparison)</span>
amalgkit<span class="w"> </span>csca<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--out_dir<span class="w"> </span>output/amalgkit/work<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--orthogroup_table<span class="w"> </span><span class="s2">&quot;&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--batch_effect_alg<span class="w"> </span>no
</pre></div>
</div>
<p><strong>Result</strong>: Correlation analysis within single species</p>
</section>
</section>
<section id="visualization-customization">
<h2>Visualization Customization<a class="headerlink" href="#visualization-customization" title="Link to this heading"></a></h2>
<section id="sample-group-colors">
<h3>Sample Group Colors<a class="headerlink" href="#sample-group-colors" title="Link to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Custom colors for each sample group</span>
amalgkit<span class="w"> </span>csca<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--sample_group<span class="w"> </span>brain,liver,heart<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--sample_group_color<span class="w"> </span><span class="s2">&quot;#d95f02ff,#1b9e77ff,#7570b3ff&quot;</span>
</pre></div>
</div>
<p><strong>Color Format</strong>: Hex codes with alpha channel (<code class="docutils literal notranslate"><span class="pre">#RRGGBBAA</span></code>)</p>
<p><strong>Default Colors</strong>: Automatically assigned if not specified</p>
</section>
<section id="batch-effect-algorithm-matching">
<h3>Batch Effect Algorithm Matching<a class="headerlink" href="#batch-effect-algorithm-matching" title="Link to this heading"></a></h3>
<p><strong>CRITICAL</strong>: Must match the algorithm used in <code class="docutils literal notranslate"><span class="pre">curate</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># If curate used --batch_effect_alg no</span>
amalgkit<span class="w"> </span>csca<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--batch_effect_alg<span class="w"> </span>no

<span class="c1"># If curate used --batch_effect_alg sva</span>
amalgkit<span class="w"> </span>csca<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--batch_effect_alg<span class="w"> </span>sva
</pre></div>
</div>
<p><strong>Mismatch</strong>: Will cause errors or incorrect results</p>
</section>
</section>
<section id="troubleshooting">
<h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Link to this heading"></a></h2>
<section id="issue-r-package-errors">
<h3>Issue: R package errors<a class="headerlink" href="#issue-r-package-errors" title="Link to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Error</span> <span class="ow">in</span> <span class="n">library</span><span class="p">(</span><span class="n">Rtsne</span><span class="p">):</span> <span class="n">there</span> <span class="ow">is</span> <span class="n">no</span> <span class="n">package</span> <span class="n">called</span> <span class="s1">&#39;Rtsne&#39;</span>
</pre></div>
</div>
<p><strong>Solution</strong>: Install missing packages or skip optional features</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Install missing packages</span>
<span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;Rtsne&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1"># If needed</span>
</pre></div>
</div>
<p><strong>Workaround</strong>: csca works without optional packages, some plots may be simplified</p>
</section>
<section id="issue-no-orthogroups-found">
<h3>Issue: No orthogroups found<a class="headerlink" href="#issue-no-orthogroups-found" title="Link to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">Warning</span><span class="p">:</span> <span class="n">No</span> <span class="n">orthogroups</span> <span class="n">matched</span> <span class="ow">in</span> <span class="n">expression</span> <span class="n">data</span>
</pre></div>
</div>
<p><strong>Causes</strong>:</p>
<ol class="arabic simple">
<li><p>ID mismatch between expression matrices and orthogroup table</p></li>
<li><p>Orthogroups not generated yet</p></li>
<li><p>Species not in orthogroup table</p></li>
</ol>
<p><strong>Solutions</strong>:</p>
<ol class="arabic">
<li><p>Verify orthogroup table includes study species:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>head<span class="w"> </span>-1<span class="w"> </span>output/orthogroups/Orthogroups.tsv<span class="w"> </span><span class="p">|</span><span class="w"> </span>tr<span class="w"> </span><span class="s1">&#39;\t&#39;</span><span class="w"> </span><span class="s1">&#39;\n&#39;</span>
<span class="c1"># Should list your species</span>
</pre></div>
</div>
</li>
<li><p>Check ID formats match</p></li>
<li><p>Use single-species mode if no orthogroups:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>amalgkit<span class="w"> </span>csca<span class="w"> </span>--orthogroup_table<span class="w"> </span><span class="s2">&quot;&quot;</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="issue-empty-plots-generated">
<h3>Issue: Empty plots generated<a class="headerlink" href="#issue-empty-plots-generated" title="Link to this heading"></a></h3>
<p><strong>Diagnosis</strong>: PDF files exist but are empty or minimal</p>
<p><strong>Causes</strong>:</p>
<ol class="arabic simple">
<li><p>Too few samples (&lt;2 per species)</p></li>
<li><p>All samples identical (no variation)</p></li>
<li><p>Expression matrix empty</p></li>
</ol>
<p><strong>Solutions</strong>:</p>
<ol class="arabic">
<li><p>Verify expression matrices have data:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wc<span class="w"> </span>-l<span class="w"> </span>output/work/curate/*/tables/*.tc.tsv
</pre></div>
</div>
</li>
<li><p>Check sample counts:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cut<span class="w"> </span>-f1<span class="w"> </span>output/work/metadata/metadata.tsv<span class="w"> </span><span class="p">|</span><span class="w"> </span>tail<span class="w"> </span>-n<span class="w"> </span>+2<span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span><span class="p">|</span><span class="w"> </span>uniq<span class="w"> </span>-c
</pre></div>
</div>
</li>
<li><p>Ensure samples have variation (check CVs in summary tables)</p></li>
</ol>
</section>
<section id="issue-batch-effect-algorithm-mismatch">
<h3>Issue: Batch effect algorithm mismatch<a class="headerlink" href="#issue-batch-effect-algorithm-mismatch" title="Link to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Error</span><span class="p">:</span> <span class="n">Expression</span> <span class="n">matrices</span> <span class="n">don</span><span class="s1">&#39;t match batch_effect_alg</span>
</pre></div>
</div>
<p><strong>Solutions</strong>:</p>
<ol class="arabic">
<li><p>Check what was used in curate:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Inspect curate output directory names</span>
ls<span class="w"> </span>output/work/curate/*/tables/*.no.tc.tsv
<span class="c1"># &quot;no&quot; indicates --batch_effect_alg no</span>
</pre></div>
</div>
</li>
<li><p>Match the algorithm:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>amalgkit<span class="w"> </span>csca<span class="w"> </span>--batch_effect_alg<span class="w"> </span>no<span class="w">  </span><span class="c1"># Match curate setting</span>
</pre></div>
</div>
</li>
</ol>
</section>
</section>
<section id="best-practices">
<h2>Best Practices<a class="headerlink" href="#best-practices" title="Link to this heading"></a></h2>
<section id="match-batch-effect-algorithm">
<h3>1. Match Batch Effect Algorithm<a class="headerlink" href="#match-batch-effect-algorithm" title="Link to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use same setting as curate</span>
<span class="nv">curate_batch_alg</span><span class="o">=</span><span class="s2">&quot;no&quot;</span><span class="w">  </span><span class="c1"># From curate step</span>

amalgkit<span class="w"> </span>csca<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--batch_effect_alg<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$curate_batch_alg</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--out_dir<span class="w"> </span>output/work
</pre></div>
</div>
</section>
<section id="verify-input-data-quality">
<h3>2. Verify Input Data Quality<a class="headerlink" href="#verify-input-data-quality" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check curated matrices are ready</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="n">curate_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;output/work/curate&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">species_dir</span> <span class="ow">in</span> <span class="n">curate_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*/tables&quot;</span><span class="p">):</span>
    <span class="n">tsv</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">species_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*.no.tc.tsv&quot;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">tsv</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">tsv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">species_dir</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> genes, </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> samples&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="inspect-correlation-patterns">
<h3>3. Inspect Correlation Patterns<a class="headerlink" href="#inspect-correlation-patterns" title="Link to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># After csca, examine correlation matrix</span>
head<span class="w"> </span>-20<span class="w"> </span>output/work/csca/*/tables/*_correlation_matrix.tsv

<span class="c1"># Look for:</span>
<span class="c1"># - High within-species correlations (&gt;0.8)</span>
<span class="c1"># - Cross-species correlations (typically 0.5-0.9)</span>
<span class="c1"># - Low correlations indicate divergence or quality issues</span>
</pre></div>
</div>
</section>
<section id="use-custom-colors-for-clarity">
<h3>4. Use Custom Colors for Clarity<a class="headerlink" href="#use-custom-colors-for-clarity" title="Link to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Choose colors that are distinguishable</span>
amalgkit<span class="w"> </span>csca<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--sample_group<span class="w"> </span>species1,species2,species3,species4<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--sample_group_color<span class="w"> </span><span class="s2">&quot;#1f77b4ff,#ff7f0eff,#2ca02cff,#d62728ff&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="real-world-examples">
<h2>Real-World Examples<a class="headerlink" href="#real-world-examples" title="Link to this heading"></a></h2>
<section id="example-1-four-ant-species-brain-comparison">
<h3>Example 1: Four Ant Species Brain Comparison<a class="headerlink" href="#example-1-four-ant-species-brain-comparison" title="Link to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># After running curate for each species</span>
amalgkit<span class="w"> </span>csca<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--out_dir<span class="w"> </span>output/ant_brain_comparative<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--orthogroup_table<span class="w"> </span>output/ant_orthogroups/Orthogroups.tsv<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--sample_group<span class="w"> </span>brain<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--batch_effect_alg<span class="w"> </span>no<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--sample_group_color<span class="w"> </span><span class="s2">&quot;#d95f02ff,#1b9e77ff,#7570b3ff,#e7298aff&quot;</span>
</pre></div>
</div>
<p><strong>Result</strong>:</p>
<ul class="simple">
<li><p>Correlation heatmap showing brain expression similarity</p></li>
<li><p>PCA plot with species clusters (showing phylogenetic relationships)</p></li>
<li><p>Dendrogram showing evolutionary relationships</p></li>
<li><p>5 PDF visualizations + 3 data tables</p></li>
</ul>
</section>
<section id="example-2-cross-species-tissue-specific-analysis">
<h3>Example 2: Cross-Species Tissue-Specific Analysis<a class="headerlink" href="#example-2-cross-species-tissue-specific-analysis" title="Link to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compare brain and liver across species</span>
amalgkit<span class="w"> </span>csca<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--out_dir<span class="w"> </span>output/tissue_comparative<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--sample_group<span class="w"> </span>brain,liver<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--orthogroup_table<span class="w"> </span>output/orthogroups/Orthogroups.tsv<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--batch_effect_alg<span class="w"> </span>no
</pre></div>
</div>
<p><strong>Result</strong>: Visualizations showing tissue-specific vs. species-specific patterns</p>
</section>
<section id="example-3-comprehensive-multi-species-analysis">
<h3>Example 3: Comprehensive Multi-Species Analysis<a class="headerlink" href="#example-3-comprehensive-multi-species-analysis" title="Link to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Full comparative analysis</span>
amalgkit<span class="w"> </span>csca<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--out_dir<span class="w"> </span>output/comprehensive_comparative<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--orthogroup_table<span class="w"> </span>output/orthogroups/Orthogroups.tsv<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--dir_busco<span class="w"> </span>output/busco<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--batch_effect_alg<span class="w"> </span>no
</pre></div>
</div>
<p><strong>Result</strong>: Complete correlation analysis with all samples, all tissues, all species</p>
</section>
</section>
<section id="integration-with-metainformant-workflow">
<h2>Integration with METAINFORMANT Workflow<a class="headerlink" href="#integration-with-metainformant-workflow" title="Link to this heading"></a></h2>
<section id="multi-species-workflow">
<h3>Multi-Species Workflow<a class="headerlink" href="#multi-species-workflow" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">metainformant.rna.workflow</span><span class="w"> </span><span class="kn">import</span> <span class="n">execute_workflow</span><span class="p">,</span> <span class="n">load_workflow_config</span>

<span class="c1"># Run workflow for each species</span>
<span class="k">for</span> <span class="n">species</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;amellifera&quot;</span><span class="p">,</span> <span class="s2">&quot;pbarbatus&quot;</span><span class="p">,</span> <span class="s2">&quot;cfloridanus&quot;</span><span class="p">]:</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="n">load_workflow_config</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;config/amalgkit_</span><span class="si">{</span><span class="n">species</span><span class="si">}</span><span class="s2">.yaml&quot;</span><span class="p">)</span>
    <span class="n">execute_workflow</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>

<span class="c1"># Then run cross-species analysis</span>
<span class="c1"># (csca requires curated data from all species)</span>
</pre></div>
</div>
</section>
<section id="configuration">
<h3>Configuration<a class="headerlink" href="#configuration" title="Link to this heading"></a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># config/amalgkit_comparative.yaml</span>
<span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="nt">csca</span><span class="p">:</span>
<span class="w">    </span><span class="nt">orthogroup_table</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output/orthogroups/Orthogroups.tsv</span>
<span class="w">    </span><span class="nt">dir_busco</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output/busco</span>
<span class="w">    </span><span class="nt">batch_effect_alg</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no</span><span class="w">  </span><span class="c1"># Match curate setting</span>
<span class="w">    </span><span class="nt">sample_group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">brain</span>
</pre></div>
</div>
</section>
</section>
<section id="interpreting-results">
<h2>Interpreting Results<a class="headerlink" href="#interpreting-results" title="Link to this heading"></a></h2>
<section id="correlation-heatmap-patterns">
<h3>Correlation Heatmap Patterns<a class="headerlink" href="#correlation-heatmap-patterns" title="Link to this heading"></a></h3>
<p><strong>High Within-Species Correlation</strong> (&gt;0.8):</p>
<ul class="simple">
<li><p>Good data quality</p></li>
<li><p>Consistent within species</p></li>
<li><p>Species-specific expression patterns</p></li>
</ul>
<p><strong>Moderate Cross-Species Correlation</strong> (0.5-0.9):</p>
<ul class="simple">
<li><p>Biological relatedness</p></li>
<li><p>Conserved expression programs</p></li>
<li><p>Expected for orthologous genes</p></li>
</ul>
<p><strong>Low Cross-Species Correlation</strong> (&lt;0.3):</p>
<ul class="simple">
<li><p>Species divergence</p></li>
<li><p>Rapid evolution</p></li>
<li><p>Or quality/data issues</p></li>
</ul>
</section>
<section id="pca-plot-patterns">
<h3>PCA Plot Patterns<a class="headerlink" href="#pca-plot-patterns" title="Link to this heading"></a></h3>
<p><strong>Species Clusters</strong>:</p>
<ul class="simple">
<li><p>Clear separation = species-specific expression</p></li>
<li><p>Overlapping = conserved expression</p></li>
<li><p>Tissue clusters = tissue-specific programs</p></li>
</ul>
<p><strong>Sample Outliers</strong>:</p>
<ul class="simple">
<li><p>Far from cluster = potential quality issue</p></li>
<li><p>Or interesting biology</p></li>
</ul>
</section>
<section id="dendrogram-patterns">
<h3>Dendrogram Patterns<a class="headerlink" href="#dendrogram-patterns" title="Link to this heading"></a></h3>
<p><strong>Species Grouping</strong>:</p>
<ul class="simple">
<li><p>Reflects evolutionary relationships</p></li>
<li><p>Close species cluster together</p></li>
<li><p>Divergence time correlates with distance</p></li>
</ul>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>PCA Methods</strong>: https://bioconductor.org/packages/release/bioc/html/pcaMethods.html</p></li>
<li><p><strong>Hierarchical Clustering</strong>: https://www.statmethods.net/advstats/cluster.html</p></li>
<li><p><strong>Cross-Species Expression</strong>: https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4312201/</p></li>
<li><p><strong>METAINFORMANT Workflow</strong>: <code class="docutils literal notranslate"><span class="pre">docs/rna/workflow.md</span></code></p></li>
</ul>
</section>
<section id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>Previous Step</strong>: <a class="reference internal" href="#cstmm.md"><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">cstmm.md</span></code></span></a> - Cross-species TMM normalization</p></li>
<li><p><strong>Previous Step</strong>: <a class="reference internal" href="#curate.md"><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">curate.md</span></code></span></a> - Quality control</p></li>
<li><p><strong>Workflow Overview</strong>: <a class="reference internal" href="../amalgkit.html"><span class="std std-doc"><code class="docutils literal notranslate"><span class="pre">../amalgkit.md</span></code></span></a></p></li>
</ul>
<hr class="docutils" />
<p><strong>Last Updated</strong>: October 29, 2025<br />
<strong>AMALGKIT Version</strong>: 0.12.19<br />
<strong>Status</strong>: ✅ Production-ready, requires R visualization packages</p>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, METAINFORMANT Contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>