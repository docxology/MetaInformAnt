============================= test session starts ==============================
platform linux -- Python 3.11.2, pytest-7.2.1, pluggy-1.0.0+repack -- /usr/bin/python3
cachedir: .pytest_cache
rootdir: /media/q/ext6/github/MetaInformAnt, configfile: pyproject.toml
plugins: anyio-3.6.2
collecting ... collected 112 items

tests/test_ml_comprehensive.py::TestBiologicalClassifier::test_classifier_initialization PASSED [  0%]
tests/test_ml_comprehensive.py::TestBiologicalClassifier::test_classifier_fit_predict PASSED [  1%]
tests/test_ml_comprehensive.py::TestBiologicalClassifier::test_classifier_feature_importance PASSED [  2%]
tests/test_ml_comprehensive.py::TestBiologicalClassifier::test_classifier_different_algorithms PASSED [  3%]
tests/test_ml_comprehensive.py::TestBiologicalClassifier::test_classifier_evaluation FAILED [  4%]
tests/test_ml_comprehensive.py::TestBiologicalClassifier::test_cross_validate_biological FAILED [  5%]
tests/test_ml_comprehensive.py::TestBiologicalRegressor::test_regressor_initialization PASSED [  6%]
tests/test_ml_comprehensive.py::TestBiologicalRegressor::test_regressor_fit_predict PASSED [  7%]
tests/test_ml_comprehensive.py::TestBiologicalRegressor::test_regressor_different_algorithms PASSED [  8%]
tests/test_ml_comprehensive.py::TestBiologicalRegressor::test_regressor_evaluation FAILED [  8%]
tests/test_ml_comprehensive.py::TestDimensionalityReduction::test_pca_basic PASSED [  9%]
tests/test_ml_comprehensive.py::TestDimensionalityReduction::test_pca_different_components PASSED [ 10%]
tests/test_ml_comprehensive.py::TestDimensionalityReduction::test_pca_standardization_effect PASSED [ 11%]
tests/test_ml_comprehensive.py::TestDimensionalityReduction::test_biological_embedding FAILED [ 12%]
tests/test_ml_comprehensive.py::TestDimensionalityReduction::test_manifold_learning_methods PASSED [ 13%]
tests/test_ml_comprehensive.py::TestValidation::test_train_test_split FAILED [ 14%]
tests/test_ml_comprehensive.py::TestValidation::test_k_fold_split PASSED [ 15%]
tests/test_ml_comprehensive.py::TestValidation::test_cross_validate FAILED [ 16%]
tests/test_ml_comprehensive.py::TestValidation::test_bootstrap_validate FAILED [ 16%]
tests/test_ml_comprehensive.py::TestValidation::test_learning_curve FAILED [ 17%]
tests/test_ml_comprehensive.py::TestMLIntegration::test_complete_classification_pipeline FAILED [ 18%]
tests/test_ml_comprehensive.py::TestMLIntegration::test_complete_regression_pipeline PASSED [ 19%]
tests/test_ml_comprehensive.py::TestMLEdgeCases::test_empty_data PASSED  [ 20%]
tests/test_ml_comprehensive.py::TestMLEdgeCases::test_single_sample PASSED [ 21%]
tests/test_ml_comprehensive.py::TestMLEdgeCases::test_mismatched_dimensions FAILED [ 22%]
tests/test_ml_comprehensive.py::TestMLEdgeCases::test_invalid_algorithms FAILED [ 23%]
tests/test_ml_comprehensive.py::TestMLEdgeCases::test_prediction_before_fitting FAILED [ 24%]
tests/test_ml_comprehensive.py::TestMLEdgeCases::test_large_dataset_performance PASSED [ 25%]
tests/test_networks_pathway.py::TestPathwayNetwork::test_pathway_network_initialization PASSED [ 25%]
tests/test_networks_pathway.py::TestPathwayNetwork::test_add_pathway PASSED [ 26%]
tests/test_networks_pathway.py::TestPathwayNetwork::test_get_pathway_genes PASSED [ 27%]
tests/test_networks_pathway.py::TestPathwayNetwork::test_get_gene_pathways PASSED [ 28%]
tests/test_networks_pathway.py::TestPathwayNetwork::test_pathway_similarity PASSED [ 29%]
tests/test_networks_pathway.py::TestPathwayNetwork::test_get_pathway_statistics FAILED [ 30%]
tests/test_networks_pathway.py::TestPathwayNetwork::test_find_overlapping_pathways FAILED [ 31%]
tests/test_networks_pathway.py::TestLoadPathwayDatabase::test_load_from_dict FAILED [ 32%]
tests/test_networks_pathway.py::TestLoadPathwayDatabase::test_load_empty_database FAILED [ 33%]
tests/test_networks_pathway.py::TestLoadPathwayDatabase::test_load_minimal_pathways FAILED [ 33%]
tests/test_networks_pathway.py::TestLoadPathwayDatabase::test_load_invalid_format PASSED [ 34%]
tests/test_networks_pathway.py::TestPathwayEnrichment::test_pathway_enrichment_basic FAILED [ 35%]
tests/test_networks_pathway.py::TestPathwayEnrichment::test_pathway_enrichment_significance FAILED [ 36%]
tests/test_networks_pathway.py::TestPathwayEnrichment::test_pathway_enrichment_no_overlap FAILED [ 37%]
tests/test_networks_pathway.py::TestPathwayEnrichment::test_pathway_enrichment_empty_gene_set FAILED [ 38%]
tests/test_networks_pathway.py::TestNetworkEnrichmentAnalysis::test_network_enrichment_basic FAILED [ 39%]
tests/test_networks_pathway.py::TestPathwayNetworkIntegration::test_complete_pathway_analysis_workflow FAILED [ 40%]
tests/test_networks_pathway.py::TestPathwayEdgeCases::test_empty_pathway_network FAILED [ 41%]
tests/test_networks_pathway.py::TestPathwayEdgeCases::test_duplicate_pathways PASSED [ 41%]
tests/test_networks_pathway.py::TestPathwayEdgeCases::test_very_large_pathway FAILED [ 42%]
tests/test_networks_pathway.py::TestPathwayEdgeCases::test_special_characters_in_names PASSED [ 43%]
tests/test_networks_pathway.py::TestNewPathwayFunctions::test_pathway_similarity PASSED [ 44%]
tests/test_networks_pathway.py::TestNewPathwayFunctions::test_pathway_activity_score PASSED [ 45%]
tests/test_networks_regulatory.py::TestGeneRegulatoryNetwork::test_grn_initialization PASSED [ 46%]
tests/test_networks_regulatory.py::TestGeneRegulatoryNetwork::test_add_regulation PASSED [ 47%]
tests/test_networks_regulatory.py::TestGeneRegulatoryNetwork::test_add_transcription_factor PASSED [ 48%]
tests/test_networks_regulatory.py::TestGeneRegulatoryNetwork::test_add_gene_metadata PASSED [ 49%]
tests/test_networks_regulatory.py::TestGeneRegulatoryNetwork::test_get_targets FAILED [ 50%]
tests/test_networks_regulatory.py::TestGeneRegulatoryNetwork::test_get_regulators FAILED [ 50%]
tests/test_networks_regulatory.py::TestGeneRegulatoryNetwork::test_filter_by_confidence FAILED [ 51%]
tests/test_networks_regulatory.py::TestGeneRegulatoryNetwork::test_filter_by_regulation_type FAILED [ 52%]
tests/test_networks_regulatory.py::TestGeneRegulatoryNetwork::test_get_network_statistics FAILED [ 53%]
tests/test_networks_regulatory.py::TestGeneRegulatoryNetwork::test_to_biological_network FAILED [ 54%]
tests/test_networks_regulatory.py::TestInferGRN::test_infer_grn_basic FAILED [ 55%]
tests/test_networks_regulatory.py::TestInferGRN::test_infer_grn_with_tf_prior FAILED [ 56%]
tests/test_networks_regulatory.py::TestInferGRN::test_infer_grn_different_methods FAILED [ 57%]
tests/test_networks_regulatory.py::TestInferGRN::test_infer_grn_thresholds FAILED [ 58%]
tests/test_networks_regulatory.py::TestInferGRN::test_infer_grn_small_dataset FAILED [ 58%]
tests/test_networks_regulatory.py::TestRegulatoryMotifs::test_regulatory_motifs_basic FAILED [ 59%]
tests/test_networks_regulatory.py::TestRegulatoryMotifs::test_regulatory_motifs_types FAILED [ 60%]
tests/test_networks_regulatory.py::TestRegulatoryMotifs::test_regulatory_motifs_confidence_filtering FAILED [ 61%]
tests/test_networks_regulatory.py::TestRegulatoryMotifs::test_regulatory_motifs_empty_grn FAILED [ 62%]
tests/test_networks_regulatory.py::TestPathwayRegulationAnalysis::test_pathway_regulation_analysis_basic FAILED [ 63%]
tests/test_networks_regulatory.py::TestPathwayRegulationAnalysis::test_pathway_regulation_analysis_enrichment FAILED [ 64%]
tests/test_networks_regulatory.py::TestPathwayRegulationAnalysis::test_pathway_regulation_analysis_empty_pathway FAILED [ 65%]
tests/test_networks_regulatory.py::TestRegulatoryNetworkIntegration::test_complete_grn_analysis_workflow FAILED [ 66%]
tests/test_networks_regulatory.py::TestRegulatoryNetworkEdgeCases::test_empty_grn_operations FAILED [ 66%]
tests/test_networks_regulatory.py::TestRegulatoryNetworkEdgeCases::test_self_regulation FAILED [ 67%]
tests/test_networks_regulatory.py::TestRegulatoryNetworkEdgeCases::test_duplicate_regulations FAILED [ 68%]
tests/test_networks_regulatory.py::TestRegulatoryNetworkEdgeCases::test_invalid_regulation_types FAILED [ 69%]
tests/test_networks_regulatory.py::TestRegulatoryNetworkEdgeCases::test_extreme_regulation_strengths FAILED [ 70%]
tests/test_networks_regulatory.py::TestRegulatoryNetworkEdgeCases::test_large_grn_performance FAILED [ 71%]
tests/test_networks_regulatory.py::TestNewRegulatoryFunctions::test_detect_regulatory_cascades PASSED [ 72%]
tests/test_networks_regulatory.py::TestNewRegulatoryFunctions::test_validate_regulation PASSED [ 73%]
tests/test_networks_ppi.py::TestProteinNetwork::test_protein_network_initialization PASSED [ 74%]
tests/test_networks_ppi.py::TestProteinNetwork::test_add_interaction PASSED [ 75%]
tests/test_networks_ppi.py::TestProteinNetwork::test_add_protein_metadata PASSED [ 75%]
tests/test_networks_ppi.py::TestProteinNetwork::test_get_protein_partners PASSED [ 76%]
tests/test_networks_ppi.py::TestProteinNetwork::test_filter_by_confidence FAILED [ 77%]
tests/test_networks_ppi.py::TestProteinNetwork::test_filter_by_evidence FAILED [ 78%]
tests/test_networks_ppi.py::TestProteinNetwork::test_get_network_statistics FAILED [ 79%]
tests/test_networks_ppi.py::TestProteinNetwork::test_to_biological_network FAILED [ 80%]
tests/test_networks_ppi.py::TestLoadStringInteractions::test_load_string_from_dataframe FAILED [ 81%]
tests/test_networks_ppi.py::TestLoadStringInteractions::test_load_string_confidence_filtering FAILED [ 82%]
tests/test_networks_ppi.py::TestLoadStringInteractions::test_load_string_empty_data FAILED [ 83%]
tests/test_networks_ppi.py::TestLoadStringInteractions::test_load_string_invalid_data FAILED [ 83%]
tests/test_networks_ppi.py::TestPredictInteractions::test_predict_interactions_basic FAILED [ 84%]
tests/test_networks_ppi.py::TestPredictInteractions::test_predict_interactions_different_methods FAILED [ 85%]
tests/test_networks_ppi.py::TestPredictInteractions::test_predict_interactions_confidence_threshold FAILED [ 86%]
tests/test_networks_ppi.py::TestPredictInteractions::test_predict_interactions_empty_network FAILED [ 87%]
tests/test_networks_ppi.py::TestFunctionalEnrichmentPPI::test_functional_enrichment_basic FAILED [ 88%]
tests/test_networks_ppi.py::TestFunctionalEnrichmentPPI::test_functional_enrichment_complex_analysis FAILED [ 89%]
tests/test_networks_ppi.py::TestFunctionalEnrichmentPPI::test_functional_enrichment_no_annotation FAILED [ 90%]
tests/test_networks_ppi.py::TestFunctionalEnrichmentPPI::test_functional_enrichment_statistical_significance FAILED [ 91%]
tests/test_networks_ppi.py::TestPPINetworkIntegration::test_complete_ppi_analysis_workflow FAILED [ 91%]
tests/test_networks_ppi.py::TestPPIEdgeCases::test_empty_ppi_network FAILED [ 92%]
tests/test_networks_ppi.py::TestPPIEdgeCases::test_duplicate_interactions PASSED [ 93%]
tests/test_networks_ppi.py::TestPPIEdgeCases::test_self_interactions PASSED [ 94%]
tests/test_networks_ppi.py::TestPPIEdgeCases::test_invalid_confidence_values PASSED [ 95%]
tests/test_networks_ppi.py::TestPPIEdgeCases::test_large_ppi_network PASSED [ 96%]
tests/test_networks_ppi.py::TestNewPPIMethods::test_get_protein_partners PASSED [ 97%]
tests/test_networks_ppi.py::TestNewPPIMethods::test_protein_similarity PASSED [ 98%]
tests/test_networks_ppi.py::TestNewPPIMethods::test_detect_complexes FAILED [ 99%]
tests/test_networks_ppi.py::TestNewPPIMethods::test_export_to_string_format PASSED [100%]

=================================== FAILURES ===================================
_____________ TestBiologicalClassifier.test_classifier_evaluation ______________
tests/test_ml_comprehensive.py:152: in test_classifier_evaluation
    results = evaluate_classifier(classifier=clf, X=self.X, y=self.y)
E   TypeError: evaluate_classifier() got an unexpected keyword argument 'X'
___________ TestBiologicalClassifier.test_cross_validate_biological ____________
tests/test_ml_comprehensive.py:176: in test_cross_validate_biological
    assert 0.0 <= results[accuracy_key] <= 1.0
E   TypeError: '<=' not supported between instances of 'float' and 'list'
______________ TestBiologicalRegressor.test_regressor_evaluation _______________
tests/test_ml_comprehensive.py:269: in test_regressor_evaluation
    results = evaluate_regressor(regressor=reg, X=self.X, y=self.y)
E   TypeError: evaluate_regressor() got an unexpected keyword argument 'X'
____________ TestDimensionalityReduction.test_biological_embedding _____________
tests/test_ml_comprehensive.py:368: in test_biological_embedding
    embedding = biological_embedding(X=self.X, method="pca", n_components=3, labels=self.labels)
src/metainformant/ml/dimensionality.py:224: in biological_embedding
    embedding, components, explained_var = reduce_dimensions_pca(X_weighted, n_components=n_components, **kwargs)
E   TypeError: reduce_dimensions_pca() got an unexpected keyword argument 'labels'
_____________________ TestValidation.test_train_test_split _____________________
tests/test_ml_comprehensive.py:445: in test_train_test_split
    assert len(train_set.intersection(test_set)) == 0
E   assert 36 == 0
E    +  where 36 = len({0, 1, 2, 3, 4, 5, ...})
E    +    where {0, 1, 2, 3, 4, 5, ...} = <built-in method intersection of set object at 0x7fe8211d0040>({0, 1, 2, 3, 4, 5, ...})
E    +      where <built-in method intersection of set object at 0x7fe8211d0040> = {0, 1, 2, 3, 4, 5, ...}.intersection
______________________ TestValidation.test_cross_validate ______________________
tests/test_ml_comprehensive.py:478: in test_cross_validate
    cv_results = cross_validate(X=self.X, y=self.y, classifier_func=mock_classifier, cv_folds=3, random_state=42)
E   TypeError: cross_validate() missing 1 required positional argument: 'model_func'
____________________ TestValidation.test_bootstrap_validate ____________________
tests/test_ml_comprehensive.py:503: in test_bootstrap_validate
    bootstrap_results = bootstrap_validate(
src/metainformant/ml/validation.py:237: in bootstrap_validate
    model = model_func(X_train, y_train, **model_kwargs)
E   TypeError: TestValidation.test_bootstrap_validate.<locals>.mock_model() missing 2 required positional arguments: 'X_test' and 'y_test'
______________________ TestValidation.test_learning_curve ______________________
tests/test_ml_comprehensive.py:531: in test_learning_curve
    curve_results = learning_curve(
E   TypeError: learning_curve() missing 1 required positional argument: 'model_func'
___________ TestMLIntegration.test_complete_classification_pipeline ____________
tests/test_ml_comprehensive.py:609: in test_complete_classification_pipeline
    assert cv_results[accuracy_key] > 0.5
E   TypeError: '>' not supported between instances of 'list' and 'float'
__________________ TestMLEdgeCases.test_mismatched_dimensions __________________
tests/test_ml_comprehensive.py:692: in test_mismatched_dimensions
    clf.fit(X, y)
src/metainformant/ml/classification.py:55: in fit
    self.feature_importance_ = self._rf_feature_importance(X, y)
src/metainformant/ml/classification.py:162: in _rf_feature_importance
    baseline_accuracy = self._calculate_accuracy(X, y, X, y)
src/metainformant/ml/classification.py:198: in _calculate_accuracy
    predictions = self._centroid_predict_with_data(X_test, X_train, y_train)
src/metainformant/ml/classification.py:356: in _centroid_predict_with_data
    class_samples = X_train[class_mask]
E   IndexError: boolean index did not match indexed array along dimension 0; dimension is 100 but corresponding boolean dimension is 50
___________________ TestMLEdgeCases.test_invalid_algorithms ____________________
tests/test_ml_comprehensive.py:696: in test_invalid_algorithms
    with pytest.raises(ValueError, match="Unknown algorithm"):
E   Failed: DID NOT RAISE <class 'ValueError'>
________________ TestMLEdgeCases.test_prediction_before_fitting ________________
tests/test_ml_comprehensive.py:708: in test_prediction_before_fitting
    clf.predict(X_test)
src/metainformant/ml/classification.py:97: in predict
    raise ValueError("Classifier must be fitted before prediction")
E   ValueError: Classifier must be fitted before prediction

During handling of the above exception, another exception occurred:
tests/test_ml_comprehensive.py:707: in test_prediction_before_fitting
    with pytest.raises(ValueError, match="not fitted"):
E   AssertionError: Regex pattern did not match.
E    Regex: 'not fitted'
E    Input: 'Classifier must be fitted before prediction'
________________ TestPathwayNetwork.test_get_pathway_statistics ________________
tests/test_networks_pathway.py:125: in test_get_pathway_statistics
    stats = self.pathway_net.get_statistics()
E   AttributeError: 'PathwayNetwork' object has no attribute 'get_statistics'
______________ TestPathwayNetwork.test_find_overlapping_pathways _______________
tests/test_networks_pathway.py:136: in test_find_overlapping_pathways
    overlapping = self.pathway_net.find_overlapping_pathways("pathway_001")
E   AttributeError: 'PathwayNetwork' object has no attribute 'find_overlapping_pathways'
_________________ TestLoadPathwayDatabase.test_load_from_dict __________________
tests/test_networks_pathway.py:158: in test_load_from_dict
    pathway_network = load_pathway_database(pathway_data)
src/metainformant/networks/pathway.py:268: in load_pathway_database
    with open(pathway_file, "r") as f:
E   TypeError: expected str, bytes or os.PathLike object, not dict
_______________ TestLoadPathwayDatabase.test_load_empty_database _______________
tests/test_networks_pathway.py:176: in test_load_empty_database
    pathway_network = load_pathway_database(empty_data)
src/metainformant/networks/pathway.py:268: in load_pathway_database
    with open(pathway_file, "r") as f:
E   TypeError: expected str, bytes or os.PathLike object, not dict
______________ TestLoadPathwayDatabase.test_load_minimal_pathways ______________
tests/test_networks_pathway.py:190: in test_load_minimal_pathways
    pathway_network = load_pathway_database(minimal_data)
src/metainformant/networks/pathway.py:268: in load_pathway_database
    with open(pathway_file, "r") as f:
E   TypeError: expected str, bytes or os.PathLike object, not dict
_____________ TestPathwayEnrichment.test_pathway_enrichment_basic ______________
tests/test_networks_pathway.py:252: in test_pathway_enrichment_basic
    assert isinstance(results, dict)
E   AssertionError: assert False
E    +  where False = isinstance([{'background_size': 33, 'fold_enrichment': 2.2, 'metadata': {'category': 'cell_division', 'name': 'Cell Cycle'}, 'overlap_size': 6, ...}, {'background_size': 33, 'fold_enrichment': 0.9166666666666667, 'metadata': {'category': 'cell_death', 'name': 'Apoptosis'}, 'overlap_size': 2, ...}, {'background_size': 33, 'fold_enrichment': 0.24444444444444444, 'metadata': {'category': 'energy', 'name': 'Metabolism'}, 'overlap_size': 1, ...}], dict)
__________ TestPathwayEnrichment.test_pathway_enrichment_significance __________
tests/test_networks_pathway.py:275: in test_pathway_enrichment_significance
    for pathway_id, result in results.items():
E   AttributeError: 'list' object has no attribute 'items'
___________ TestPathwayEnrichment.test_pathway_enrichment_no_overlap ___________
tests/test_networks_pathway.py:291: in test_pathway_enrichment_no_overlap
    for result in results.values():
E   AttributeError: 'list' object has no attribute 'values'
_________ TestPathwayEnrichment.test_pathway_enrichment_empty_gene_set _________
tests/test_networks_pathway.py:302: in test_pathway_enrichment_empty_gene_set
    assert isinstance(results, dict)
E   assert False
E    +  where False = isinstance([], dict)
_________ TestNetworkEnrichmentAnalysis.test_network_enrichment_basic __________
tests/test_networks_pathway.py:343: in test_network_enrichment_basic
    results = network_enrichment_analysis(
E   TypeError: network_enrichment_analysis() got an unexpected keyword argument 'gene_list'
____ TestPathwayNetworkIntegration.test_complete_pathway_analysis_workflow _____
tests/test_networks_pathway.py:382: in test_complete_pathway_analysis_workflow
    pathway_network = load_pathway_database(pathway_data)
src/metainformant/networks/pathway.py:268: in load_pathway_database
    with open(pathway_file, "r") as f:
E   TypeError: expected str, bytes or os.PathLike object, not dict
_______________ TestPathwayEdgeCases.test_empty_pathway_network ________________
tests/test_networks_pathway.py:419: in test_empty_pathway_network
    stats = empty_network.get_statistics()
E   AttributeError: 'PathwayNetwork' object has no attribute 'get_statistics'
_________________ TestPathwayEdgeCases.test_very_large_pathway _________________
tests/test_networks_pathway.py:451: in test_very_large_pathway
    stats = pathway_network.get_statistics()
E   AttributeError: 'PathwayNetwork' object has no attribute 'get_statistics'
__________________ TestGeneRegulatoryNetwork.test_get_targets __________________
tests/test_networks_regulatory.py:130: in test_get_targets
    assert set(targets_tf1) == expected_targets_tf1
E   TypeError: unhashable type: 'dict'
________________ TestGeneRegulatoryNetwork.test_get_regulators _________________
tests/test_networks_regulatory.py:144: in test_get_regulators
    assert set(regulators_target2) == expected_regulators
E   TypeError: unhashable type: 'dict'
_____________ TestGeneRegulatoryNetwork.test_filter_by_confidence ______________
tests/test_networks_regulatory.py:156: in test_filter_by_confidence
    high_conf_grn = self.grn.filter_by_confidence(threshold=0.85)
E   AttributeError: 'GeneRegulatoryNetwork' object has no attribute 'filter_by_confidence'
___________ TestGeneRegulatoryNetwork.test_filter_by_regulation_type ___________
tests/test_networks_regulatory.py:170: in test_filter_by_regulation_type
    activation_grn = self.grn.filter_by_regulation_type("activation")
E   AttributeError: 'GeneRegulatoryNetwork' object has no attribute 'filter_by_regulation_type'
____________ TestGeneRegulatoryNetwork.test_get_network_statistics _____________
tests/test_networks_regulatory.py:192: in test_get_network_statistics
    stats = self.grn.get_network_statistics()
E   AttributeError: 'GeneRegulatoryNetwork' object has no attribute 'get_network_statistics'
_____________ TestGeneRegulatoryNetwork.test_to_biological_network _____________
tests/test_networks_regulatory.py:206: in test_to_biological_network
    bio_network = self.grn.to_biological_network()
E   AttributeError: 'GeneRegulatoryNetwork' object has no attribute 'to_biological_network'
______________________ TestInferGRN.test_infer_grn_basic _______________________
tests/test_networks_regulatory.py:265: in test_infer_grn_basic
    assert len(grn.genes) == self.n_genes
E   assert 0 == 8
E    +  where 0 = len(set())
E    +    where set() = <metainformant.networks.regulatory.GeneRegulatoryNetwork object at 0x7fe8164f1a50>.genes
E    +  and   8 = <test_networks_regulatory.TestInferGRN object at 0x7fe821301ed0>.n_genes
__________________ TestInferGRN.test_infer_grn_with_tf_prior ___________________
tests/test_networks_regulatory.py:273: in test_infer_grn_with_tf_prior
    grn = infer_grn(
E   TypeError: infer_grn() got an unexpected keyword argument 'tf_genes'
________________ TestInferGRN.test_infer_grn_different_methods _________________
tests/test_networks_regulatory.py:301: in test_infer_grn_different_methods
    assert len(grn.genes) == self.n_genes
E   assert 0 == 8
E    +  where 0 = len(set())
E    +    where set() = <metainformant.networks.regulatory.GeneRegulatoryNetwork object at 0x7fe8164c0c10>.genes
E    +  and   8 = <test_networks_regulatory.TestInferGRN object at 0x7fe821302c50>.n_genes
____________________ TestInferGRN.test_infer_grn_thresholds ____________________
tests/test_networks_regulatory.py:327: in test_infer_grn_thresholds
    assert len(strict_grn.genes) == len(permissive_grn.genes) == self.n_genes
E   AssertionError: assert 0 == 4
E    +  where 0 = len(set())
E    +    where set() = <metainformant.networks.regulatory.GeneRegulatoryNetwork object at 0x7fe8165038d0>.genes
E    +  and   4 = len({'Gene_0', 'Gene_1', 'Gene_3', 'Gene_5'})
E    +    where {'Gene_0', 'Gene_1', 'Gene_3', 'Gene_5'} = <metainformant.networks.regulatory.GeneRegulatoryNetwork object at 0x7fe816500a50>.genes
__________________ TestInferGRN.test_infer_grn_small_dataset ___________________
tests/test_networks_regulatory.py:339: in test_infer_grn_small_dataset
    assert len(grn.genes) == 5
E   AssertionError: assert 4 == 5
E    +  where 4 = len({'Gene_0', 'Gene_1', 'Gene_2', 'Gene_3'})
E    +    where {'Gene_0', 'Gene_1', 'Gene_2', 'Gene_3'} = <metainformant.networks.regulatory.GeneRegulatoryNetwork object at 0x7fe81650d5d0>.genes
______________ TestRegulatoryMotifs.test_regulatory_motifs_basic _______________
tests/test_networks_regulatory.py:369: in test_regulatory_motifs_basic
    assert isinstance(motifs, list)
E   AssertionError: assert False
E    +  where False = isinstance({'bifan': [], 'feed_forward_loop': [{'intermediate': 'TF2', 'regulator1': 'TF1', 'target': 'TARGET'}], 'feedback_loop': [{'gene1': 'TF4', 'gene2': 'TF3'}, {'gene1': 'TF3', 'gene2': 'TF4'}]}, list)
______________ TestRegulatoryMotifs.test_regulatory_motifs_types _______________
tests/test_networks_regulatory.py:386: in test_regulatory_motifs_types
    motif_types = [motif["motif_type"] for motif in motifs]
tests/test_networks_regulatory.py:386: in <listcomp>
    motif_types = [motif["motif_type"] for motif in motifs]
E   TypeError: string indices must be integers, not 'str'
_______ TestRegulatoryMotifs.test_regulatory_motifs_confidence_filtering _______
tests/test_networks_regulatory.py:402: in test_regulatory_motifs_confidence_filtering
    high_conf_motifs = regulatory_motifs(self.grn, min_confidence=0.8)
E   TypeError: regulatory_motifs() got an unexpected keyword argument 'min_confidence'
____________ TestRegulatoryMotifs.test_regulatory_motifs_empty_grn _____________
tests/test_networks_regulatory.py:421: in test_regulatory_motifs_empty_grn
    assert isinstance(motifs, list)
E   AssertionError: assert False
E    +  where False = isinstance({'bifan': [], 'feed_forward_loop': [], 'feedback_loop': []}, list)
_____ TestPathwayRegulationAnalysis.test_pathway_regulation_analysis_basic _____
tests/test_networks_regulatory.py:454: in test_pathway_regulation_analysis_basic
    analysis_results = pathway_regulation_analysis(grn=self.grn, pathway_genes=self.pathway_genes)
src/metainformant/networks/regulatory.py:660: in pathway_regulation_analysis
    for pathway_id, genes in pathway_genes.items():
E   AttributeError: 'list' object has no attribute 'items'
__ TestPathwayRegulationAnalysis.test_pathway_regulation_analysis_enrichment ___
tests/test_networks_regulatory.py:477: in test_pathway_regulation_analysis_enrichment
    analysis_results = pathway_regulation_analysis(
E   TypeError: pathway_regulation_analysis() got an unexpected keyword argument 'calculate_enrichment'
_ TestPathwayRegulationAnalysis.test_pathway_regulation_analysis_empty_pathway _
tests/test_networks_regulatory.py:494: in test_pathway_regulation_analysis_empty_pathway
    analysis_results = pathway_regulation_analysis(grn=self.grn, pathway_genes=[])
src/metainformant/networks/regulatory.py:660: in pathway_regulation_analysis
    for pathway_id, genes in pathway_genes.items():
E   AttributeError: 'list' object has no attribute 'items'
_____ TestRegulatoryNetworkIntegration.test_complete_grn_analysis_workflow _____
tests/test_networks_regulatory.py:525: in test_complete_grn_analysis_workflow
    inferred_grn = infer_grn(
E   TypeError: infer_grn() got an unexpected keyword argument 'tf_genes'
___________ TestRegulatoryNetworkEdgeCases.test_empty_grn_operations ___________
tests/test_networks_regulatory.py:579: in test_empty_grn_operations
    stats = empty_grn.get_network_statistics()
E   AttributeError: 'GeneRegulatoryNetwork' object has no attribute 'get_network_statistics'
_____________ TestRegulatoryNetworkEdgeCases.test_self_regulation ______________
tests/test_networks_regulatory.py:596: in test_self_regulation
    assert "AUTOREGULATOR" in grn.get_targets("AUTOREGULATOR")
E   AssertionError: assert 'AUTOREGULATOR' in [('AUTOREGULATOR', {'confidence': 0.8, 'strength': 0.7, 'type': 'activation'})]
E    +  where [('AUTOREGULATOR', {'confidence': 0.8, 'strength': 0.7, 'type': 'activation'})] = <bound method GeneRegulatoryNetwork.get_targets of <metainformant.networks.regulatory.GeneRegulatoryNetwork object at 0x7fe8164cb510>>('AUTOREGULATOR')
E    +    where <bound method GeneRegulatoryNetwork.get_targets of <metainformant.networks.regulatory.GeneRegulatoryNetwork object at 0x7fe8164cb510>> = <metainformant.networks.regulatory.GeneRegulatoryNetwork object at 0x7fe8164cb510>.get_targets
__________ TestRegulatoryNetworkEdgeCases.test_duplicate_regulations ___________
tests/test_networks_regulatory.py:616: in test_duplicate_regulations
    assert "TARGET" in targets
E   AssertionError: assert 'TARGET' in [('TARGET', {'confidence': 0.8, 'strength': 0.7, 'type': 'activation'}), ('TARGET', {'confidence': 0.9, 'strength': 0.9, 'type': 'repression'})]
_________ TestRegulatoryNetworkEdgeCases.test_invalid_regulation_types _________
tests/test_networks_regulatory.py:630: in test_invalid_regulation_types
    activation_grn = grn.filter_by_regulation_type("activation")
E   AttributeError: 'GeneRegulatoryNetwork' object has no attribute 'filter_by_regulation_type'
_______ TestRegulatoryNetworkEdgeCases.test_extreme_regulation_strengths _______
tests/test_networks_regulatory.py:646: in test_extreme_regulation_strengths
    stats = grn.get_network_statistics()
E   AttributeError: 'GeneRegulatoryNetwork' object has no attribute 'get_network_statistics'
__________ TestRegulatoryNetworkEdgeCases.test_large_grn_performance ___________
tests/test_networks_regulatory.py:674: in test_large_grn_performance
    assert len(large_grn.genes) >= n_genes  # At least the target genes
E   AssertionError: assert 92 >= 100
E    +  where 92 = len({'Gene_0', 'Gene_1', 'Gene_10', 'Gene_11', 'Gene_12', 'Gene_13', ...})
E    +    where {'Gene_0', 'Gene_1', 'Gene_10', 'Gene_11', 'Gene_12', 'Gene_13', ...} = <metainformant.networks.regulatory.GeneRegulatoryNetwork object at 0x7fe816816590>.genes
_________________ TestProteinNetwork.test_filter_by_confidence _________________
tests/test_networks_ppi.py:124: in test_filter_by_confidence
    high_conf_network = self.ppi_network.filter_by_confidence(threshold=0.8)
E   AttributeError: 'ProteinNetwork' object has no attribute 'filter_by_confidence'
__________________ TestProteinNetwork.test_filter_by_evidence __________________
tests/test_networks_ppi.py:138: in test_filter_by_evidence
    exp_network = self.ppi_network.filter_by_evidence("experimental")
E   AttributeError: 'ProteinNetwork' object has no attribute 'filter_by_evidence'
________________ TestProteinNetwork.test_get_network_statistics ________________
tests/test_networks_ppi.py:150: in test_get_network_statistics
    stats = self.ppi_network.get_network_statistics()
E   AttributeError: 'ProteinNetwork' object has no attribute 'get_network_statistics'
________________ TestProteinNetwork.test_to_biological_network _________________
tests/test_networks_ppi.py:164: in test_to_biological_network
    bio_network = self.ppi_network.to_biological_network()
E   AttributeError: 'ProteinNetwork' object has no attribute 'to_biological_network'
__________ TestLoadStringInteractions.test_load_string_from_dataframe __________
tests/test_networks_ppi.py:201: in test_load_string_from_dataframe
    ppi_network = load_string_interactions(
E   TypeError: load_string_interactions() got an unexpected keyword argument 'interactions_df'
_______ TestLoadStringInteractions.test_load_string_confidence_filtering _______
tests/test_networks_ppi.py:228: in test_load_string_confidence_filtering
    high_conf_network = load_string_interactions(interactions_df=interactions_data, confidence_threshold=800)
E   TypeError: load_string_interactions() got an unexpected keyword argument 'interactions_df'
____________ TestLoadStringInteractions.test_load_string_empty_data ____________
tests/test_networks_ppi.py:243: in test_load_string_empty_data
    ppi_network = load_string_interactions(interactions_df=empty_interactions)
E   TypeError: load_string_interactions() got an unexpected keyword argument 'interactions_df'
___________ TestLoadStringInteractions.test_load_string_invalid_data ___________
tests/test_networks_ppi.py:260: in test_load_string_invalid_data
    ppi_network = load_string_interactions(interactions_df=invalid_data)
E   TypeError: load_string_interactions() got an unexpected keyword argument 'interactions_df'
___________ TestPredictInteractions.test_predict_interactions_basic ____________
tests/test_networks_ppi.py:292: in test_predict_interactions_basic
    predictions = predict_interactions(
E   TypeError: predict_interactions() got an unexpected keyword argument 'target_proteins'
_____ TestPredictInteractions.test_predict_interactions_different_methods ______
tests/test_networks_ppi.py:317: in test_predict_interactions_different_methods
    predictions = predict_interactions(
E   TypeError: predict_interactions() got an unexpected keyword argument 'target_proteins'
____ TestPredictInteractions.test_predict_interactions_confidence_threshold ____
tests/test_networks_ppi.py:334: in test_predict_interactions_confidence_threshold
    strict_predictions = predict_interactions(
E   TypeError: predict_interactions() got an unexpected keyword argument 'target_proteins'
_______ TestPredictInteractions.test_predict_interactions_empty_network ________
tests/test_networks_ppi.py:351: in test_predict_interactions_empty_network
    predictions = predict_interactions(target_proteins=["P1", "P2"], known_network=empty_network)
E   TypeError: predict_interactions() got an unexpected keyword argument 'target_proteins'
_________ TestFunctionalEnrichmentPPI.test_functional_enrichment_basic _________
tests/test_networks_ppi.py:398: in test_functional_enrichment_basic
    enrichment_results = functional_enrichment_ppi(
E   TypeError: functional_enrichment_ppi() got an unexpected keyword argument 'protein_list'
___ TestFunctionalEnrichmentPPI.test_functional_enrichment_complex_analysis ____
tests/test_networks_ppi.py:416: in test_functional_enrichment_complex_analysis
    enrichment_results = functional_enrichment_ppi(
E   TypeError: functional_enrichment_ppi() got an unexpected keyword argument 'protein_list'
_____ TestFunctionalEnrichmentPPI.test_functional_enrichment_no_annotation _____
tests/test_networks_ppi.py:440: in test_functional_enrichment_no_annotation
    enrichment_results = functional_enrichment_ppi(
E   TypeError: functional_enrichment_ppi() got an unexpected keyword argument 'protein_list'
_ TestFunctionalEnrichmentPPI.test_functional_enrichment_statistical_significance _
tests/test_networks_ppi.py:456: in test_functional_enrichment_statistical_significance
    high_results = functional_enrichment_ppi(
E   TypeError: functional_enrichment_ppi() got an unexpected keyword argument 'protein_list'
________ TestPPINetworkIntegration.test_complete_ppi_analysis_workflow _________
tests/test_networks_ppi.py:502: in test_complete_ppi_analysis_workflow
    stats = ppi_network.get_network_statistics()
E   AttributeError: 'ProteinNetwork' object has no attribute 'get_network_statistics'
___________________ TestPPIEdgeCases.test_empty_ppi_network ____________________
tests/test_networks_ppi.py:540: in test_empty_ppi_network
    stats = empty_network.get_network_statistics()
E   AttributeError: 'ProteinNetwork' object has no attribute 'get_network_statistics'
___________________ TestNewPPIMethods.test_detect_complexes ____________________
tests/test_networks_ppi.py:647: in test_detect_complexes
    complexes = detect_complexes(ppi, min_confidence=0.7, min_size=3)
src/metainformant/networks/ppi.py:661: in detect_complexes
    community_proteins = defaultdict(list)
E   NameError: name 'defaultdict' is not defined

Slow tests (>1.0s):
  14.81s: tests/test_ml_comprehensive.py::TestDimensionalityReduction::test_manifold_learning_methods
  7.41s: tests/test_networks_ppi.py::TestPPIEdgeCases::test_large_ppi_network
  1.55s: tests/test_ml_comprehensive.py::TestMLEdgeCases::test_large_dataset_performance
=========================== short test summary info ============================
FAILED tests/test_ml_comprehensive.py::TestBiologicalClassifier::test_classifier_evaluation
FAILED tests/test_ml_comprehensive.py::TestBiologicalClassifier::test_cross_validate_biological
FAILED tests/test_ml_comprehensive.py::TestBiologicalRegressor::test_regressor_evaluation
FAILED tests/test_ml_comprehensive.py::TestDimensionalityReduction::test_biological_embedding
FAILED tests/test_ml_comprehensive.py::TestValidation::test_train_test_split
FAILED tests/test_ml_comprehensive.py::TestValidation::test_cross_validate - ...
FAILED tests/test_ml_comprehensive.py::TestValidation::test_bootstrap_validate
FAILED tests/test_ml_comprehensive.py::TestValidation::test_learning_curve - ...
FAILED tests/test_ml_comprehensive.py::TestMLIntegration::test_complete_classification_pipeline
FAILED tests/test_ml_comprehensive.py::TestMLEdgeCases::test_mismatched_dimensions
FAILED tests/test_ml_comprehensive.py::TestMLEdgeCases::test_invalid_algorithms
FAILED tests/test_ml_comprehensive.py::TestMLEdgeCases::test_prediction_before_fitting
FAILED tests/test_networks_pathway.py::TestPathwayNetwork::test_get_pathway_statistics
FAILED tests/test_networks_pathway.py::TestPathwayNetwork::test_find_overlapping_pathways
FAILED tests/test_networks_pathway.py::TestLoadPathwayDatabase::test_load_from_dict
FAILED tests/test_networks_pathway.py::TestLoadPathwayDatabase::test_load_empty_database
FAILED tests/test_networks_pathway.py::TestLoadPathwayDatabase::test_load_minimal_pathways
FAILED tests/test_networks_pathway.py::TestPathwayEnrichment::test_pathway_enrichment_basic
FAILED tests/test_networks_pathway.py::TestPathwayEnrichment::test_pathway_enrichment_significance
FAILED tests/test_networks_pathway.py::TestPathwayEnrichment::test_pathway_enrichment_no_overlap
FAILED tests/test_networks_pathway.py::TestPathwayEnrichment::test_pathway_enrichment_empty_gene_set
FAILED tests/test_networks_pathway.py::TestNetworkEnrichmentAnalysis::test_network_enrichment_basic
FAILED tests/test_networks_pathway.py::TestPathwayNetworkIntegration::test_complete_pathway_analysis_workflow
FAILED tests/test_networks_pathway.py::TestPathwayEdgeCases::test_empty_pathway_network
FAILED tests/test_networks_pathway.py::TestPathwayEdgeCases::test_very_large_pathway
FAILED tests/test_networks_regulatory.py::TestGeneRegulatoryNetwork::test_get_targets
FAILED tests/test_networks_regulatory.py::TestGeneRegulatoryNetwork::test_get_regulators
FAILED tests/test_networks_regulatory.py::TestGeneRegulatoryNetwork::test_filter_by_confidence
FAILED tests/test_networks_regulatory.py::TestGeneRegulatoryNetwork::test_filter_by_regulation_type
FAILED tests/test_networks_regulatory.py::TestGeneRegulatoryNetwork::test_get_network_statistics
FAILED tests/test_networks_regulatory.py::TestGeneRegulatoryNetwork::test_to_biological_network
FAILED tests/test_networks_regulatory.py::TestInferGRN::test_infer_grn_basic
FAILED tests/test_networks_regulatory.py::TestInferGRN::test_infer_grn_with_tf_prior
FAILED tests/test_networks_regulatory.py::TestInferGRN::test_infer_grn_different_methods
FAILED tests/test_networks_regulatory.py::TestInferGRN::test_infer_grn_thresholds
FAILED tests/test_networks_regulatory.py::TestInferGRN::test_infer_grn_small_dataset
FAILED tests/test_networks_regulatory.py::TestRegulatoryMotifs::test_regulatory_motifs_basic
FAILED tests/test_networks_regulatory.py::TestRegulatoryMotifs::test_regulatory_motifs_types
FAILED tests/test_networks_regulatory.py::TestRegulatoryMotifs::test_regulatory_motifs_confidence_filtering
FAILED tests/test_networks_regulatory.py::TestRegulatoryMotifs::test_regulatory_motifs_empty_grn
FAILED tests/test_networks_regulatory.py::TestPathwayRegulationAnalysis::test_pathway_regulation_analysis_basic
FAILED tests/test_networks_regulatory.py::TestPathwayRegulationAnalysis::test_pathway_regulation_analysis_enrichment
FAILED tests/test_networks_regulatory.py::TestPathwayRegulationAnalysis::test_pathway_regulation_analysis_empty_pathway
FAILED tests/test_networks_regulatory.py::TestRegulatoryNetworkIntegration::test_complete_grn_analysis_workflow
FAILED tests/test_networks_regulatory.py::TestRegulatoryNetworkEdgeCases::test_empty_grn_operations
FAILED tests/test_networks_regulatory.py::TestRegulatoryNetworkEdgeCases::test_self_regulation
FAILED tests/test_networks_regulatory.py::TestRegulatoryNetworkEdgeCases::test_duplicate_regulations
FAILED tests/test_networks_regulatory.py::TestRegulatoryNetworkEdgeCases::test_invalid_regulation_types
FAILED tests/test_networks_regulatory.py::TestRegulatoryNetworkEdgeCases::test_extreme_regulation_strengths
FAILED tests/test_networks_regulatory.py::TestRegulatoryNetworkEdgeCases::test_large_grn_performance
FAILED tests/test_networks_ppi.py::TestProteinNetwork::test_filter_by_confidence
FAILED tests/test_networks_ppi.py::TestProteinNetwork::test_filter_by_evidence
FAILED tests/test_networks_ppi.py::TestProteinNetwork::test_get_network_statistics
FAILED tests/test_networks_ppi.py::TestProteinNetwork::test_to_biological_network
FAILED tests/test_networks_ppi.py::TestLoadStringInteractions::test_load_string_from_dataframe
FAILED tests/test_networks_ppi.py::TestLoadStringInteractions::test_load_string_confidence_filtering
FAILED tests/test_networks_ppi.py::TestLoadStringInteractions::test_load_string_empty_data
FAILED tests/test_networks_ppi.py::TestLoadStringInteractions::test_load_string_invalid_data
FAILED tests/test_networks_ppi.py::TestPredictInteractions::test_predict_interactions_basic
FAILED tests/test_networks_ppi.py::TestPredictInteractions::test_predict_interactions_different_methods
FAILED tests/test_networks_ppi.py::TestPredictInteractions::test_predict_interactions_confidence_threshold
FAILED tests/test_networks_ppi.py::TestPredictInteractions::test_predict_interactions_empty_network
FAILED tests/test_networks_ppi.py::TestFunctionalEnrichmentPPI::test_functional_enrichment_basic
FAILED tests/test_networks_ppi.py::TestFunctionalEnrichmentPPI::test_functional_enrichment_complex_analysis
FAILED tests/test_networks_ppi.py::TestFunctionalEnrichmentPPI::test_functional_enrichment_no_annotation
FAILED tests/test_networks_ppi.py::TestFunctionalEnrichmentPPI::test_functional_enrichment_statistical_significance
FAILED tests/test_networks_ppi.py::TestPPINetworkIntegration::test_complete_ppi_analysis_workflow
FAILED tests/test_networks_ppi.py::TestPPIEdgeCases::test_empty_ppi_network
FAILED tests/test_networks_ppi.py::TestNewPPIMethods::test_detect_complexes
======================== 69 failed, 43 passed in 26.54s ========================
